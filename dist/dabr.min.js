const t=t=>!!t&&t.constructor&&"Array"==t.constructor.name,e=e=>0==e&&!t(e)||!!e&&"object"!=typeof e&&e.constructor&&"Array"!=e.constructor.name,n=t=>!!t&&"object"==typeof t&&t.constructor&&"Array"!=t.constructor.name,o=t=>null==t||null==t,r=e=>0==e&&!t(e)||!!e&&"number"==typeof e,s=e=>0==e&&!t(e)||!!e,a=t=>!!t&&"function"==typeof t,i=(t,e)=>Object.entries(t).map(e),l=(t,e)=>(t=>{let e={};return t.forEach(([t,n])=>{e[t]=n}),e})(Object.entries(t).map(([t,n])=>{let o=e(n,t);return o?[t,o]:null}).filter(s)),c=(...t)=>Object.assign({},...t),u=t=>t.slice(),d=t=>Object.assign({},t),h=(t,e)=>{let n=[],o=[];return function t(e,r){var s;if(null==e&&null==r)return!0;if(null==e&&null==r)return!0;if(isNaN(e)&&isNaN(r)&&"number"==typeof e&&"number"==typeof r)return!0;if(e===r)return!0;if("function"==typeof e&&"function"==typeof r||e instanceof Date&&r instanceof Date||e instanceof RegExp&&r instanceof RegExp||e instanceof String&&r instanceof String||e instanceof Number&&r instanceof Number)return e.toString()===r.toString();if(!(e instanceof Object&&r instanceof Object))return!1;if(e.isPrototypeOf(r)||r.isPrototypeOf(e))return!1;if(e.constructor!==r.constructor)return!1;if(e.prototype!==r.prototype)return!1;if(n.indexOf(e)>-1||o.indexOf(r)>-1)return!1;for(s in r){if(r.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;if(typeof r[s]!=typeof e[s])return!1}for(s in e){if(r.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;if(typeof r[s]!=typeof e[s])return!1;switch(typeof e[s]){case"object":case"function":if(n.push(e),o.push(r),!t(e[s],r[s]))return!1;n.pop(),o.pop();break;default:if(e[s]!==r[s])return!1}}return!0}(t,e)},f=e=>t(e)?e:[e],v=(t,e,n)=>t.map((t,o)=>n(t,e[o])),p=(t,e)=>v(t,e,(t,e)=>t+e),y=t=>e=>t.reduce((t,e)=>e(t),e),m=(t=null,e=new WeakMap)=>b({val:t,old:null,trans:new Set,changed:!1,isNode:!0,info:e}),b=t=>new Proxy(t,{set:w,get:g}),g=(t,e)=>"target"==e?t:t[e],w=(t,e,n)=>"val"==e&&(t.changed||h(t.val,n)||(t.old=t.val,t.val=n,t.changed=!0,t.trans.forEach(e=>{e.func()&&t.trans.delete(e)}),t.changed=!1),!0),_=t=>t.map(t=>s(t.val)).reduce((t,e)=>t&&e,!0),E=(...e)=>{const n=e.length,o=e[n-1];let r,s;a(o)?(r=o,s=null):(r=e[n-2],s=o);const i=e.splice(0,n-1).map(e=>t(e)?e:[e]).reduce((t,e)=>t.concat(e));if(i.length>0){const t=r.length,e=[];for(let n=0;n<t;n++)e.push(i[n]);const n=m(),o=()=>{_(i)&&(n.val=r(...e.map(t=>t.val)))},a={nodes:i,func:o,ref:s};return i.forEach(t=>{const e=t.target.trans;if(!e.has(a))if(s){const t=[...e].find(t=>t.ref==s);t?(x(t),e.add(a)):e.add(a)}else e.has(a)||e.add(a)}),_(i)&&o(),{node:n,transition:a}}return null},z=(...t)=>{const{node:e}=E(...t);return e},O=(...e)=>{const n=e.length,o=e[n-1];let r,s;a(o)?(r=o,s=null):(r=e[n-2],s=o);const i=e.splice(0,n-1).map(e=>t(e)?e:[e]).reduce((t,e)=>t.concat(e));if(i.length>0){const t=r.length,e=[];for(let n=0;n<t;n++)e.push(i[n]);const n=m(),o=()=>{n.val=r(...e.map(t=>t.val))},a={nodes:i,func:o,ref:s};return i.forEach(t=>{const e=t.target.trans;if(!e.has(a))if(s){const t=[...e].find(t=>t.ref==s);t?(x(t),e.add(a)):e.add(a)}else e.has(a)||e.add(a)}),o(),{node:n,transition:a}}return null},A=(...t)=>{const{node:e}=O(...t);return e},x=t=>{t.nodes.forEach(e=>{e.target.trans.delete(t)})},M=t=>t.isNode?t:m(t),T=(t,e)=>mapN([t],t=>t[e]),S=(t,e)=>{const n=z(t,t=>t[e]);return z(n,()=>{const o=t.val;o[e]=n.val,t.val=o}),n},k=(e,n)=>{let o;return o=n?n.isNode?t(n.val)?n:z(n,f):n.isEntry?n:M(f(n)):m([]),{isTree:!0,val:e,children:o}},L=k,j=(t,e,n=[])=>k(e(t.val,t,n),t.children.isEntry?t.children:z(t.children,t=>t.map((t,o)=>j(t,e,n.concat(o))))),B=(t,e=[])=>e=>j(e,t,[]),C={isEntry:!0},N=(t,e)=>(t.children.isEntry?t.children=e:t.children=z(t.children,t=>t.map(t=>N(t,e))),t),R=(t,e)=>{let n;return n=t.children==e?C:z(t.children,t=>t.map(t=>R(t,e))),k(t.val,n)},W=(e,n,o=null,r=[])=>{const s=n(e,o,r),a=t(s),i=a?s[0]:s,l=a?s[1]:o,c=i?R(i,e.children):null,u=z(e.children,t=>t.map((t,e)=>W(t,n,l,r.concat(e))));return i?N(c,u):null},D=(t,e=null,n=[])=>o=>W(o,t,e,n),P=(t,e)=>{let n=null;return W(t,(t,o,r)=>{h(r,e)&&(n=t)}),n},H=t=>e=>P(e,t),V=t=>j(t,t=>k(t,C)),$=t=>{const e=t.val;return e.isTree?$(N(e,t.children)):(t.children=z(t.children,t=>t.map($)),t)},I={color:({elem:t,node:e})=>()=>{t.style["background-color"]=e.val},show:({elem:t,node:e})=>()=>{e.val?t.style.display="block":t.style.display="none"}};var q=t=>j(t,t=>(t.style&&i(t.style,([e,n])=>{const o=M(n),r=I[e];if(r){const e=r({node:o,elem:t.inst.dom,rect:t});t.tran([o],e)}}),t));const F={click:({elem:t,channel:e})=>{t.addEventListener("click",t=>{e.put=t})},mouseOver:({elem:t,channel:e})=>{t.addEventListener("mouseover",t=>{e.put=t})},mouseEnter:({elem:t,channel:e})=>{t.addEventListener("mouseenter",t=>{e.put=t})},mouseMove:({elem:t,channel:e})=>{t.addEventListener("mousemove",t=>{e.put=t})},drag:({elem:t,channel:e})=>{let n=!1;t.addEventListener("mousedown",t=>{console.log("aAAAAAA"),n=!0,e.put=t}),t.addEventListener("mouseup",()=>{console.log("BBBBBBBBB"),n=!1,e.put=!1}),t.addEventListener("mousemove",t=>{n&&(e.put=t)})},mouseOut:({elem:t,channel:e})=>{t.addEventListener("mouseout",t=>{e.put=t})}};var G=t=>j(t,t=>(t.events&&i(t.events,([e,n])=>{if(n.isChan){const o=F[e];o&&o({channel:n,elem:t.inst.dom,rect:t})}}),t));const J=(t,e)=>K({get:t,ports:new Set,isChan:!0,info:e}),K=t=>new Proxy(t,{get:Q,set:U}),Q=(t,e)=>"target"==e?t:t[e],U=(t,e,n)=>"put"==e&&(t.get=n,t.ports.forEach(t=>{t.func()}),!0),X=(t,e)=>{const n={chans:t,func:e};return t.forEach(t=>{t.ports.add(n)}),n},Y=(t,e,n)=>{const o={chans:e,func:n,ref:t};return e.forEach(e=>{const n=e.ports,r=[...n].find(e=>e.ref==t);r?(Z(r),n.add(o)):n.add(o)}),o},Z=t=>{t.chans.forEach(e=>{e.target.ports.delete(t)})},tt=(t,e)=>{const n=X(t,()=>{e(),Z(n)});return n},et=(t,e)=>{const n=J();return X(t,()=>{const t=e();s(t)&&(n.put=t)}),n},nt=(t,e)=>et(t,()=>e(...t.map(t=>t.get))),ot=(t,e)=>nt([t],t=>e(t)?t:null),rt=t=>{const e={pos:m(),siz:m(),posAbs:m(),sizAbs:m(),scale:m([1,1])},n={isRect:!0,isSupp:!1,isCore:!0,oldVersions:[],init:J(),stop:J(),created:m(),removed:m(),inst:null,renderTrans:new Set,domEvents:[],data:new WeakMap([[rt,{}]]),layout:e,tran:st},o={};if(t.data)if((r=t.data).constructor&&"WeakMap"==r.constructor.name)o.data=t.data;else{const e=f(t.data);o.data=new WeakMap(e.map(({key:t,val:e})=>[t,[e]]))}var r;t.layout&&(o.layout=c(e,t.layout));const s=c(n,t,o);var a,i;return s.layout&&(s.layout=(a=M,i=s.layout,l(i,a))),s},st=function(...t){const{transition:e,node:n}=E(...t);return this.renderTrans.add(e),n},at=t=>{const e=rt(t);return e.isSupp=!0,e.isCore=!1,e},it=(t,e)=>{const o={};if(i(e,([e,r])=>{t[e]&&n(t[e])?o[e]=c(t[e],r):o[e]=r}),e.data){const n=f(e.data);o.data=t.data,n.forEach(({key:t,val:e})=>{if(o.data.has(t)){const e=o.data.get(t);o.data.set(e.concat(t))}else o.data.set(t,[e])})}return o.inst=null,o.init=J(),o.created=m(),o.oldVersions=t.oldVersions.concat([t]),rt(c(t,o))},lt=(t,e)=>({key:t,val:e}),ct=t=>it(at({layout:{pos:[0,0],siz:[100,100]}}),t||{}),ut=t=>{const e=t.inst.dom;t.domEvents.forEach(({name:t,func:n})=>{e["on"+t]=null})},dt=(t,e,n)=>{t.inst.dom["on"+e]=n,t.domEvents.push({name:e,func:n})},ht=(t,e)=>({rel:t,px:e}),ft=t=>ht(0,t),vt=(t,e)=>{const n=s(t.rel)?t:{px:0,rel:t},o=s(e.rel)?e:{px:0,rel:e};return ht(n.rel+o.rel,n.px+o.px)},pt=(t,e)=>{const n=s(e.rel)?e:{px:0,rel:e};return ht(n.rel*t,n.px*t)},yt=(t,e)=>[vt(t[0],e[0]),vt(t[1],e[1])],mt=(t,e)=>[pt(t,e[0]),pt(t,e[1])],bt=t=>s(t.px)?t.px:0,gt=t=>s(t.rel)?t.rel:t,wt=([t,e])=>[[gt(t),gt(e)],[bt(t),bt(e)]],_t=([t,e])=>[ft(t),ft(e)],Et=([t,e])=>[zt(t),zt(e)],zt=t=>t.rel?d(t):t,Ot={},At={fullSize:({elem:t,rect:e,tree:n,node:o})=>{e.tran([n.children],()=>{const t=n.children.val.map(t=>{const e=t.val.layout;return z([e.posAbs,e.sizAbs],()=>[p(e.posAbs.val,e.sizAbs.val),yt(e.pos.val,e.siz.val)])});z(t,()=>{o.val=Et(t.map(t=>t.val).reduce((t,e)=>{const[n,o]=t,[r,s]=e,[a,i]=n,[l,c]=o,[u,d]=r,[h,f]=s;return[a>u?[a,l]:[u,h],i>d?[i,c]:[d,f]]})[1])})})},fullSizeCor:({elem:t,rect:e,tree:n,node:o})=>{const r=m(),s=(At.fullSize({elem:t,rect:e,tree:n,node:r}),e.layout.sizAbs),a=e.layout.scale,i=e.inst.par.layout.sizAbs;e.tran([r,s,i,a],()=>{const[[t,e],[n,l]]=wt(r.val),[c,u]=s.val,[d,h]=i.val;o.val=[ht(t*c/d*a.val[0],n),ht(e*u/h*a.val[1],l)]})},scrollAbs:({elem:t,rect:e,node:n})=>{dt(e,"scroll",()=>{n.val=[t.scrollLeft,t.scrollTop]}),e.tran([n],()=>{const[e,o]=n.val;t.scrollLeft=e,t.scrollTop=o})},scroll:({elem:t,rect:e,node:n})=>{const o=e.tran([e.layout.sizAbs],e=>{const n=t.scrollWidth,o=t.scrollHeight,r=Math.round(e[0]),s=Math.round(e[1]);return[n-r>=0?n-r:0,o-s>=0?o-s:0]});dt(e,"scroll",()=>{const e=o.val;n.val=[0===e[0]?0:t.scrollLeft/e[0]*100,0===e[1]?0:t.scrollTop/e[1]*100]}),e.tran([n],()=>{const[e,r]=n.val,s=o.val,a=[Math.round(e/100*s[0]),Math.round(r/100*s[1])];t.scrollLeft!=a[0]&&(t.scrollLeft=a[0]),t.scrollTop!=a[1]&&(t.scrollTop=a[1])},Ot)}};var xt=t=>j(t,(t,e)=>(t.nodes&&i(t.nodes,([n,o])=>{const r="fullSize"==n?o:M(o),s=At[n];s&&s({node:r,elem:t.inst.dom,rect:t,tree:e})}),t));const Mt=(t,e)=>k(rt(t),e),Tt=(t,e)=>k(at(t),e),St=t=>e=>j(n=>t(n)?e(n):n),kt=(t,e)=>(n,o)=>j(r=>t(r)?n(r):e(r)?o(r):r),Lt=St(t=>t.isCore),jt=St(t=>t.isSupp),Bt=St(t=>t.isTree),Ct=t=>e=>k(t(e.val),e.children),Nt=(t,e,n,o)=>{const r=o.scale,s=t.pos;n.tran([s,r],()=>{const[t,n]=wt(s.val),o=r.val;e.style.left=`calc(${t[0]*o[0]}% + ${n[0]}px)`,e.style.top=`calc(${t[1]*o[1]}% + ${n[1]}px)`});const a=t.siz;n.tran([a,r],()=>{const[t,n]=wt(a.val),o=r.val;e.style.width=`calc(${t[0]*o[0]}% + ${n[0]}px)`,e.style.height=`calc(${t[1]*o[1]}% + ${n[1]}px)`})},Rt=(t,e,n,o,r,s,a,i)=>z([e,n,o,r,s],(t,e,n,o,r)=>{const[s,l]=wt(t),[c,u]=wt(e);let d=[r[0]*n[0]/100,r[1]*n[1]/100],h=[c[0]*d[0],c[1]*d[1]],f=[s[0]*d[0]+o[0],s[1]*d[1]+o[1]];a.val=p(f,l),i.val=p(h,u)});var Wt=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,o){return t[0]===e&&(n=o,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),o=this.__entries__[n];return o&&o[1]},e.prototype.set=function(e,n){var o=t(this.__entries__,e);~o?this.__entries__[o][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,o=t(n,e);~o&&n.splice(o,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,o=this.__entries__;n<o.length;n++){var r=o[n];t.call(e,r[1],r[0])}},e}()}(),Dt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Pt="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Ht="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Pt):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var Vt=["top","right","bottom","left","width","height","size","weight"],$t="undefined"!=typeof MutationObserver,It=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,o=!1,r=0;function s(){n&&(n=!1,t()),o&&i()}function a(){Ht(s)}function i(){var t=Date.now();if(n){if(t-r<2)return;o=!0}else n=!0,o=!1,setTimeout(a,e);r=t}return i}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Dt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),$t?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Dt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;Vt.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),qt=function(t,e){for(var n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},Ft=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Pt},Gt=Yt(0,0,0,0);function Jt(t){return parseFloat(t)||0}function Kt(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+Jt(t["border-"+n+"-width"])}),0)}function Qt(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return Gt;var o=Ft(t).getComputedStyle(t),r=function(t){for(var e={},n=0,o=["top","right","bottom","left"];n<o.length;n++){var r=o[n],s=t["padding-"+r];e[r]=Jt(s)}return e}(o),s=r.left+r.right,a=r.top+r.bottom,i=Jt(o.width),l=Jt(o.height);if("border-box"===o.boxSizing&&(Math.round(i+s)!==e&&(i-=Kt(o,"left","right")+s),Math.round(l+a)!==n&&(l-=Kt(o,"top","bottom")+a)),!function(t){return t===Ft(t).document.documentElement}(t)){var c=Math.round(i+s)-e,u=Math.round(l+a)-n;1!==Math.abs(c)&&(i-=c),1!==Math.abs(u)&&(l-=u)}return Yt(r.left,r.top,i,l)}var Ut="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof Ft(t).SVGGraphicsElement}:function(t){return t instanceof Ft(t).SVGElement&&"function"==typeof t.getBBox};function Xt(t){return Dt?Ut(t)?function(t){var e=t.getBBox();return Yt(0,0,e.width,e.height)}(t):Qt(t):Gt}function Yt(t,e,n,o){return{x:t,y:e,width:n,height:o}}var Zt=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Yt(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=Xt(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),te=function(t,e){var n,o,r,s,a,i,l,c=(o=(n=e).x,r=n.y,s=n.width,a=n.height,i="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(i.prototype),qt(l,{x:o,y:r,width:s,height:a,top:r,right:o+s,bottom:a+r,left:o}),l);qt(this,{target:t,contentRect:c})},ee=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new Wt,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Ft(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Zt(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof Ft(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new te(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),ne="undefined"!=typeof WeakMap?new WeakMap:new Wt,oe=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=It.getInstance(),o=new ee(e,n,this);ne.set(this,o)};["observe","unobserve","disconnect"].forEach((function(t){oe.prototype[t]=function(){var e;return(e=ne.get(this))[t].apply(e,arguments)}}));var re=void 0!==Pt.ResizeObserver?Pt.ResizeObserver:oe;const se=t=>q(G(xt(le(t)))),ae=(t,e)=>q(G(xt(ce(t,e)))),ie=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],le=t=>{const e=m(ie()),n={layout:{posAbs:m([0,0]),sizAbs:e,scale:m([1,1])},flex:!1,inst:{dom:document.body}};return window.j=e,window.onresize=()=>{e.val=ie()},ue($(t),n)},ce=(t,e)=>{const n=m([e.offsetWidth,e.offsetHeight]),o={layout:{posAbs:m([0,0]),sizAbs:n,scale:m([1,1])},flex:!1,inst:{dom:e}};return ve(e),new re(t=>{const e=t[0],{width:o,height:r}=e.contentRect;n.val=[o,r]}).observe(e),ue($(t),o)},ue=(t,e)=>{const n=t.val;fe();const o=document.createElement("div");ve(o),e.inst.dom.appendChild(o),n.inst={dom:o,par:e};const r=n.layout;return Nt(r,o,n,e.layout),Rt(0,r.pos,r.siz,e.layout.scale,e.layout.posAbs,e.layout.sizAbs,r.posAbs,r.sizAbs),n.oldVersions.forEach(t=>{t.inst=n.inst,t.init.put=!0,t.created.val=!0}),n.init.put=!0,n.created.val=!0,de(t.children,n),t},de=(t,e)=>{e.tran(t,()=>{let n=t.val,o=t.old;o||(o=[]),n||(n=[]);const r=o.filter(t=>!n.includes(t));n.filter(t=>!o.includes(t)).forEach(t=>ue(t,e)),r.forEach(t=>he(t))})},he=t=>{const e=t.val,n=e.inst.dom;return n.parentNode.removeChild(n),e.renderTrans.forEach(t=>{x(t)}),ut(e),e.inst=null,e.stop.put=!0,e.removed.val=!0,e.created.val=!1,t.children.val=t.children.val.map(he),t},fe=()=>{if(!document.getElementById("dabr-style")){const t=".dabr::-webkit-scrollbar {width: 0 !important;height: 0 !important;}.dabr {overflow: -moz-scrollbars-none;scrollbar-width: none;-ms-overflow-style: none;}",e=document.createElement("style");e.setAttribute("id","dabr-style"),e.textContent=t,document.head.append(e)}},ve=t=>{t.className="dabr",t.style.position="absolute",t.style["overflow-y"]="scroll",t.style["overflow-x"]="scroll"},pe=(t,e)=>{const n=e.val,o=m(),r=m(),s=z(t,({color:t})=>t),a=z(t,({width:t})=>t);z([a],()=>{const t=a.val;r.val=[ht(100,-2*t),ht(100,-2*t)],o.val=[ft(t),ft(t)]});const i=at({layout:{pos:n.layout.pos,siz:n.layout.siz},data:lt(pe,{node:t,outter:!0,inner:!1}),style:{color:s}});return k(i,k(it(n,{layout:{pos:o,siz:r},data:lt(pe,{node:t,inner:!0,outter:!1})}),e.children))},ye=t=>e=>pe(t,e),me=(t,e)=>k(ct({layout:{pos:e.val.layout.pos,siz:e.val.layout.siz},data:lt(me,t),style:{show:t}}),k(it(e.val,{layout:{pos:[0,0],siz:[100,100]}}),e.children)),be=t=>e=>me(t,e),ge=(t,e)=>{const n=m(),o=m(),r=lt(ge,{node:t,outter:!0,inner:!1}),s=e.val,a=m(),i=at({layout:{pos:s.layout.pos,siz:s.layout.siz,sizAbs:a},data:r}),l=it(s,{layout:{pos:n,siz:o}});return z([t,a],()=>{const[e,r]=_e(t.val,a.val);n.val=[ft(e[0]),ft(e[1])],o.val=[ft(r[0]),ft(r[1])]}),k(i,k(l,e.children))},we=t=>e=>ge(t,e),_e=(t,e)=>{let n=e[0],o=e[1],r=[0,0],s=[0,0],a=t[0]/t[1];return t[0]>t[1]?(r[0]=n,r[1]=r[0]/a,r[1]>o?(r[1]=o,r[0]=r[1]*a,s[1]=0,s[0]=(n-r[0])/2):(s[0]=0,s[1]=(o-r[1])/2)):(n=e[0],o=e[1],r[1]=o,r[0]=r[1]*a,r[0]>n?(r[0]=n,r[1]=r[0]/a,s[0]=0,s[1]=(o-r[1])/2):(s[1]=0,s[0]=(n-r[0])/2)),[s,r]},Ee=(t,e)=>{const n=m(),o=l(e,t=>{const e=!!t.destroy&&t.destroy,n=m(!1);return{show:n,rectT:me(n,t.content||t),destroy:e}}),r=m([100,100]);return z([t],()=>{const e=t.val;n.val=i(o,([t,n])=>{const{show:o,rectT:r,destroy:s}=n;return t==e?(o.val=!0,r):s?null:(o.val=!1,r)}).filter(s),r.val=[{rel:100,px:.01},100],r.val=[100,100]}),k(at({layout:{pos:[0,0],siz:r}}),n)},ze=t=>t,Oe=t=>t*t,Ae=t=>e=>Math.pow(e,t),xe=t=>e=>1-t(e),Me=(t,{finalVal:e,totalTime:n,timeFunction:o=ze,delta:r=10})=>{const s=t.val;if(s){const a=t.info.get(Me);if(!h(s,e)&&!a){t.info.set(Me,!0);let a=Se(s,e);if(-1!=a){const[e,i]=a,l=Le(e),c=Le(i),u=v(c,l,(t,e)=>t-e);let d=r;const h=setInterval(()=>{d>=n&&(t.info.set(Me,!1),clearInterval(h),d=n);let a=p((i=u,c=o(d/n),i.map(t=>t*c)),l);var i,c;let f=ke(je(a,e),s);t.val=f,d+=r},r);return{handle:h,node:t}}}}return null},Te=({handle:t,node:e})=>{e.info.set(Me,!1),clearInterval(t)},Se=(r,s)=>{if(h(r,s))return-1;if("boolean"==typeof r)return[r,s];if(t(r)&&!t(s)&&!o(s)||t(s)&&!t(r)&&!o(r)||e(r)&&!e(s)&&!o(s)||e(s)&&!e(r)&&!o(r))return-1;if(n(r)&&(n(s)||o(s))||n(s)&&(n(r)||o(r))){let t=r||{},e=s||{},n=d(t),o=d({...t,...e});return Object.entries(o).forEach(([r])=>{if(h(t[r],e[r]))delete o[r],delete n[r];else{let s=Se(t[r],e[r]);if(s&&-1!=s){let[t,e]=s;n[r]=t,o[r]=e}}}),[n,o]}if(t(r)&&(t(s)||o(s))||t(s)&&(t(r)||o(r))){var a=r,i=s;if(null==r&&(a=s.map(()=>null)),null==s&&(i=r.map(()=>null)),a.length==i.length){let t=u(a),e=u(i);for(let n=0;n<t.length;n++)if(h(a[n],i[n]))delete e[n],delete t[n];else{let o=Se(a[n],i[n]);if(o&&-1!=o){let[r,s]=o;t[n]=r,e[n]=s}}return[t,e]}return[r,s]}return[r,s]},ke=(e,o)=>{if(n(e)){let t={};return Object.entries(o).forEach(([r])=>{s(e[r])?t[r]=ke(e[r],o[r]):n(o[r])?t[r]=d(o[r]):t[r]=o[r]}),t}if(t(e)){let t=[];if(e.length==o.length){for(let r=0;r<o.length;r++)s(e[r])?t[r]=ke(e[r],o[r]):n(o[r])?t[r]=d(o[r]):t[r]=o[r];return t}return null}return e},Le=t=>{if(r(t))return[t];if((e=t)&&"object"==typeof e){let e=[];return Object.values(t).forEach(t=>{let n=Le(t);n&&(e=e.concat(n))}),e}return null;var e},je=(e,o)=>function e(o,a){if(r(a))return o.shift();if(n(a)){let t={};return Object.entries(a).forEach(([n,r])=>{t[n]=e(o,r)}),t}if(t(a)){let t=[];for(var i=0;i<a.length;i++)s(a[i])?t[i]=e(o,a[i]):delete t[i];return t}return null}(u(e),o),Be=t=>{const e=t.val,n=m(),o=it(e,{nodes:{scroll:n}}),r=m([50,0]);z([n],()=>{const t=n.val[1],e=95*t/100;console.log(";))))))))))",t,e),e>=0&&(r.val=[r.val[0],e])});m([0,0]);const s=m([0,0]),a=(J(),J(),J(),m([50,5])),i=(J(),k(rt({layout:{pos:[ht(100,-10),0],siz:[ht(0,10),100],sizAbs:s}}),Mt({layout:{pos:r,siz:a},style:{color:"orange"}})));return k(ct(),[k(o,t.children),i])},Ce=()=>{const t=m(location.hash.slice(1));return window.addEventListener("hashchange",()=>{"#"+t.val!=location.hash&&(t.val=location.hash.slice(1))},!1),z([t],()=>{location.hash=t.val}),t};window.c=Ce();const Ne=t=>e=>{const n=m(),o=m();return e.data.set(Ne,{size:n,dom:o}),tt([e.init],()=>{z([t],({color:t,size:n,family:r,align:s,content:a,wordBreak:i,whiteSpace:l})=>{const c=e.inst.dom,u=c.getElementsByClassName("dabr-text");let d;1==u.length?d=u[0]:(d=document.createElement("div"),c.appendChild(d)),c.style.overflow="hidden",d.style.color=t||"black",d.style["font-size"]=n||"16px",s&&(d.style["text-align"]=s),r&&(d.style["font-family"]=r),d.style["word-break"]=i||"break-all",l&&(d.style["white-space"]=l),d.classList.add("dabr-text"),d.innerText=a,o.val=d}),z([e.layout.sizAbs,t],()=>{const t=o.val,e=[t.offsetWidth,t.offsetHeight];console.log("hmmmm",e),0!=e[0]&&0!=e[1]&&(n.val=e)})}),e},Re=(t,e)=>{const n=Ne(t)(e),{size:o}=n.data.get(Ne);return z([o],()=>{const[,t]=_t(o.val),[e]=n.layout.siz.val;n.layout.siz.val=[e,t]}),n},We=t=>e=>n=>{const o=m(),r=[];e.forEach((t,e)=>{r[e]=m()}),z(e,()=>{const t=e.map(t=>(({color:t="black",family:e,align:n,content:o})=>{const r=document.createElement("div");r.style.visibility="hidden",r.style.width="max-content",r.style["font-size"]="16px",e&&(r.style["font-family"]=e),r.innerText=o,document.body.appendChild(r);const s=r.offsetWidth,a=r.offsetHeight;return r.remove(),[s,a]})(t.val));t.forEach((t,e)=>{r[e].val=t});const n=t.map(([t])=>t),s=t.map(([,t])=>t),a=n.reduce((t,e)=>Math.max(t,e)),i=s.reduce((t,e)=>t+e);o.val=[a,i]});const s=m(),a=e.length,i=e.map((e,n)=>{const i=z([e,s],()=>({...e.val,size:s.val,whiteSpace:"nowrap"})),l=n/a*100,c=z([r[n],o],([t,e],[n,o])=>[t/n*100,1/a*100]),u=t(c,l),d=at({layout:{pos:u,siz:c}});return k(Ne(i)(d))}),l=i.map(t=>t.val.layout.sizAbs);window.l=l[0],z(l.concat([o]),()=>{const t=l.map(t=>t.val[0]).reduce((t,e)=>Math.max(t,e)),e=o.val[0],n=(r=t/e*16,Math.round(1e3*(r+Number.EPSILON))/1e3);var r;s.val=n+"px"});return ge(o,k(n.val,i))},De=We((t,e)=>m([0,e])),Pe=We((t,e)=>z([t],([t,n])=>[100-t,e])),He=We((t,e)=>z([t],([t,n])=>[(100-t)/2,e])),Ve=t=>De([t]),$e=t=>(t.reduce((t,e)=>(z([t.val.layout.pos,t.val.layout.siz],()=>{const n=t.val.layout.pos.val,o=t.val.layout.siz.val,r=yt(n,o);e.val.layout.pos.val=[e.val.layout.pos.val[0],r[1]]}),e),Mt({layout:{pos:[0,0],siz:[0,0]}})),t),Ie=t=>(t.reduce((t,e)=>(z([t.val.layout.pos,t.val.layout.siz],()=>{const n=t.val.layout.pos.val,o=t.val.layout.siz.val,r=yt(n,o);e.val.layout.pos.val=[r[0],e.val.layout.pos.val[1]]}),e),Mt({layout:{pos:[0,0],siz:[0,0]}})),t),qe=t=>ct({layout:{pos:[0,0],siz:t}}),Fe=t=>qe(z([t],t=>[0,t])),Ge=t=>qe(z([t],t=>[t,0])),Je=t=>{const e=m([100,100]);return tt([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(tt([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;z([n,o,r],()=>{s.val=[n.val[0]/r.val[0]*o.val[0],n.val[1]/r.val[1]*o.val[1]]})}),t))(it(t,{layout:{siz:e},nodes:{fullSize:e}}))},Ke=t=>{const e=m([100,100]),n=z([e,t.layout.siz],([t],[,e])=>[t,e]);return tt([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(tt([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;z([n,o,r],()=>{s.val=[n.val[0]/r.val[0]*o.val[0],s.val[1]]})}),t))(it(t,{layout:{siz:n},nodes:{fullSize:e}}))},Qe=t=>{const e=m([100,100]),n=z([e,t.layout.siz],([,t],[e])=>[e,t]);return tt([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(tt([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;z([n,o,r],()=>{s.val=[s.val[0],n.val[1]/r.val[1]*o.val[1]]})}),t))(it(t,{layout:{siz:n},nodes:{fullSize:e}}))};export{ct as Dummy,Ae as EXPONENTIAL,C as Entry,xe as FLIP,ze as LINEAR,Oe as QUADRATIC,rt as Rect,Mt as RectT,at as Supp,Tt as SuppT,L as T,k as Tree,ye as _border,be as _container,B as _mapT,H as _pathT,we as _proportional,D as _walkT,G as addChans,yt as addCoord,dt as addEvent,Nt as addLayoutTriggers,vt as addLen,xt as addNodes,q as addStyle,y as applyF,_t as asPx,pe as border,J as chan,et as chanL,St as cond,kt as condElse,me as container,Et as copyCoord,zt as copyLen,Lt as core,Rt as defaultLayoutReactivity,ot as filterC,Je as flex,Ke as flexX,Qe as flexY,$ as fromStruc,bt as getPx,gt as getRel,Ce as hashNode,Ie as horizontal,Ge as horizontalSpace,lt as keyed,ht as len,Ve as line,He as linesC,De as linesL,Pe as linesR,We as linesTemplate,X as listen,tt as listenOnce,Y as listenRef,nt as mapC,j as mapT,mt as mulCoord,pt as mulLen,m as node,Re as paragraph,P as pathT,it as preserveR,ge as proportional,ft as px,ut as removeEvents,Z as removeListen,he as removeRect,x as removeTran,se as run,ae as runDOM,le as runRect,ce as runRectDOM,Be as scrollbar,qe as space,wt as splitCoord,Te as stopTimed,T as subNode,S as subNode2,jt as supp,Ee as switcher,Ne as text,Me as timed,M as toNode,V as toStruc,Ct as top,z as tran,E as tranRef,Bt as tree,A as unsafeTran,O as unsafeTranRef,$e as vertical,Fe as verticalSpace,W as walkT};
