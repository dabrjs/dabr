const e=e=>!!e&&e.constructor&&"Array"==e.constructor.name,t=t=>0==t&&!e(t)||!!t&&"object"!=typeof t&&t.constructor&&"Array"!=t.constructor.name,n=e=>!!e&&"object"==typeof e&&e.constructor&&"Array"!=e.constructor.name,l=e=>null==e||null==e,s=t=>0==t&&!e(t)||!!t&&"number"==typeof t,o=t=>0==t&&!e(t)||!!t,a=e=>!!e&&"function"==typeof e,r=(e,t)=>Object.entries(e).map(t),i=(e,t)=>(e=>{let t={};return e.forEach(([e,n])=>{t[e]=n}),t})(Object.entries(e).map(([e,n])=>{let l=t(n,e);return l?[e,l]:null}).filter(o)),c=(e,t)=>i(t,e),d=(...e)=>Object.assign({},...e),u=e=>e.slice(),h=e=>Object.assign({},e),p=(e,t)=>{let n=[],l=[];return function e(t,s){var o;if(null==t&&null==s)return!0;if(null==t&&null==s)return!0;if(isNaN(t)&&isNaN(s)&&"number"==typeof t&&"number"==typeof s)return!0;if(t===s)return!0;if("function"==typeof t&&"function"==typeof s||t instanceof Date&&s instanceof Date||t instanceof RegExp&&s instanceof RegExp||t instanceof String&&s instanceof String||t instanceof Number&&s instanceof Number)return t.toString()===s.toString();if(!(t instanceof Object&&s instanceof Object))return!1;if(t.isPrototypeOf(s)||s.isPrototypeOf(t))return!1;if(t.constructor!==s.constructor)return!1;if(t.prototype!==s.prototype)return!1;if(n.indexOf(t)>-1||l.indexOf(s)>-1)return!1;for(o in s){if(s.hasOwnProperty(o)!==t.hasOwnProperty(o))return!1;if(typeof s[o]!=typeof t[o])return!1}for(o in t){if(s.hasOwnProperty(o)!==t.hasOwnProperty(o))return!1;if(typeof s[o]!=typeof t[o])return!1;switch(typeof t[o]){case"object":case"function":if(n.push(t),l.push(s),!e(t[o],s[o]))return!1;n.pop(),l.pop();break;default:if(t[o]!==s[o])return!1}}return!0}(e,t)},f=t=>e(t)?t:[t],v=(e,t,n)=>e.map((e,l)=>n(e,t[l])),y=(e,t)=>v(e,t,(e,t)=>e+t),m=e=>t=>e.reduce((e,t)=>t(e),t),b=(e=null,t=new WeakMap)=>g({val:e,old:null,trans:new Set,changed:!1,isNode:!0,info:t,change:E,inTransaction:!1,delayedTransitions:null,delayedChanges:null}),g=e=>new Proxy(e,{set:w,get:z}),z=(e,t)=>"target"==t?e:e[t],w=(e,t,n)=>{if("val"==t){if(!e.changed&&!p(e.val,n))if(e.inTransaction){const t=e.delayedTransitions;e.delayedChanges.add({target:e,value:n}),e.trans.forEach(e=>{t.add(e)})}else e.old=e.val,e.val=n,e.changed=!0,e.trans.forEach(e=>{e.func()}),e.changed=!1;return!0}return!1},x=e=>e.map(e=>o(e.val)).reduce((e,t)=>e&&t,!0),E=function(e){this.val=e(this.val)},A=(...t)=>{const n=t.length,l=t[n-1];let s,o,r;a(l)?(s=l,o=null,r=1):(s=t[n-2],o=l,r=2);const i=t.splice(0,n-r).map(t=>e(t)?t:[t]).reduce((e,t)=>e.concat(t));if(i.length>0){const e=s.length,t=[];for(let n=0;n<e;n++)t.push(i[n]);const n=b(),l=()=>{x(i)&&(n.val=s(...t.map(e=>e.val)))},a={nodes:i,func:l,ref:o};return i.forEach(e=>{const t=e.target.trans;if(!t.has(a))if(o){const e=[...t].find(e=>e.ref==o);e?(C(e),t.add(a)):t.add(a)}else t.has(a)||t.add(a)}),x(i)&&l(),{node:n,transition:a}}return null},O=(...e)=>{const{node:t}=A(...e);return t},S=(...t)=>{const n=t.length,l=t[n-1];let s,o;a(l)?(s=l,o=null):(s=t[n-2],o=l);const r=t.splice(0,n-1).map(t=>e(t)?t:[t]).reduce((e,t)=>e.concat(t));if(r.length>0){const e=s.length,t=[];for(let n=0;n<e;n++)t.push(r[n]);const n=b(),l=()=>{n.val=s(...t.map(e=>e.val))},a={nodes:r,func:l,ref:o};return r.forEach(e=>{const t=e.target.trans;if(!t.has(a))if(o){const e=[...t].find(e=>e.ref==o);e?(C(e),t.add(a)):t.add(a)}else t.has(a)||t.add(a)}),l(),{node:n,transition:a}}return null},T=(...e)=>{const{node:t}=S(...e);return t},C=e=>{e.nodes.forEach(t=>{t.target.trans.delete(e)})},M=e=>e.isNode?e:b(e),P=(e,t)=>O([e],e=>e[t]),k=(t,n)=>{const l=T(t,e=>o(e)?e[n]:null);return T(l,()=>{const s=t.val;if(s&&"object"==typeof s){const o=e(s)?u(s):h(s);o[n]=l.val,t.val=o}else if(o(l.val)){const e={};e[n]=l.val,t.val=e}}),l},R=(t,n)=>{let l,s;e(n)?[l,s]=n:(l=n,s=n);const o=k(t,s);return t.target[l]=o,o},j=e=>{const t=b(e);if("object"==typeof e){new Set(Object.keys(e)).forEach(e=>{R(t,e)})}return t},N=(...t)=>{const n=t.length,l=t[n-1],s=t.splice(0,n-1).map(t=>e(t)?t:[t]).reduce((e,t)=>e.concat(t)),o=$(...s);l(),D(o)},$=(...e)=>{const t=new Set,n=new Set;e.forEach(e=>{e.target.inTransaction=!0,e.target.delayedTransitions=t,e.target.delayedChanges=n});return{nodes:e,delayedTransitions:t,delayedChanges:n}},D=e=>{const{nodes:t,delayedTransitions:n,delayedChanges:l}=e;l.forEach(({target:e,value:t})=>{e.old=e.val,e.val=t,e.changed=!0}),n.forEach(e=>{e.func()}),t.forEach(e=>{e.target.inTransaction=!1,e.target.changed=!1,e.target.delayedTransitions=null,e.target.delayedChanges=null})},W=(t,...n)=>{const l=n.map(t=>t?t.isNode?e(t.val)?t:O(t,f):t.isEntry?t:M(f(t)):b([]));return{isTree:!0,elem:t,children:0==l.length?b([]):1==l.length?l[0]:O(l,()=>l.map(e=>e.val).reduce((e,t)=>e.concat(t)))}},L=W,H=(e,t,n=[])=>{const l=t(e.elem,e,n),s=e.children.isEntry?e.children:O(e.children,e=>e.map((e,l)=>H(e,t,n.concat(l))));return e.elem=l,e.children=s,e},I=(e,t=[])=>n=>H(n,e,t),B={isEntry:!0},V=(e,t)=>(e.children.isEntry?e.children=t:e.children=O(e.children,e=>e.map(e=>V(e,t))),e),F=(e,t)=>{let n;return n=e.children==t?B:O(e.children,e=>e.map(e=>F(e,t))),W(e.elem,n)},Y=(t,n,l=null,s=[])=>{const o=n(t,l,s),a=e(o),r=a?o[0]:o,i=a?o[1]:l,c=r?F(r,t.children):null,d=O(t.children,e=>e.map((e,t)=>Y(e,n,i,s.concat(t))));return r?V(c,d):null},q=(e,t=null,n=[])=>l=>Y(l,e,t,n),G=(e,t)=>{let n=null;return Y(e,(e,l,s)=>{p(s,t)&&(n=e)}),n},J=e=>t=>G(t,e),K=e=>H(e,e=>W(e,B)),Q=e=>{const t=e.elem;return t.isTree?Q(V(t,e.children)):(e.children=O(e.children,e=>e.map(Q)),e)},U={color:({elem:e,node:t})=>()=>{e.style["background-color"]=t.val},show:({elem:e,node:t})=>()=>{t.val?e.style.display="block":e.style.display="none"}};var X=e=>H(e,e=>(e.style&&r(e.style,([t,n])=>{const l=M(n),s=U[t];if(s){const t=s({node:l,elem:e.inst.dom,rect:e});e.tran(l,t)}}),e));const Z={click:({rect:e,channel:t})=>{e.addEvent("click",e=>{t.put=e})},mouseOver:({rect:e,channel:t})=>{e.addEvent("mouseover",e=>{t.put=e})},mouseEnter:({rect:e,channel:t})=>{e.addEvent("mouseenter",e=>{t.put=e})},mouseMove:({rect:e,channel:t})=>{e.addEvent("mousemove",e=>{t.put=e})},drag:({rect:e,channel:t})=>{let n=!1;e.addEvent("mousedown",e=>{n=!0,t.put=e}),e.addEvent("mouseup",()=>{n=!1,t.put=!1}),e.addEvent("mousemove",e=>{n&&(t.put=e)})},mouseOut:({rect:e,channel:t})=>{e.addEvent("mouseout",e=>{t.put=e})}};var _=e=>H(e,e=>(e.events&&r(e.events,([t,n])=>{if(n.isChan){const l=Z[t];l&&l({channel:n,elem:e.inst.dom,rect:e})}}),e));const ee=(e,t)=>({rel:e,px:t}),te=e=>ee(0,e),ne=(e,t)=>{const n=o(e.rel)?e:{px:0,rel:e},l=o(t.rel)?t:{px:0,rel:t};return ee(n.rel+l.rel,n.px+l.px)},le=(e,t)=>{const n=o(t.rel)?t:{px:0,rel:t};return ee(n.rel*e,n.px*e)},se=(e,t)=>[ne(e[0],t[0]),ne(e[1],t[1])],oe=(e,t)=>[le(e,t[0]),le(e,t[1])],ae=e=>o(e.px)?e.px:0,re=e=>o(e.rel)?e.rel:e,ie=e=>ee(re(e),ae(e)),ce=([e,t])=>[[re(e),re(t)],[ae(e),ae(t)]],de=([e,t])=>[te(e),te(t)],ue=([e,t])=>[he(e),he(t)],he=e=>e.rel?h(e):e,pe=e=>ve([e,100]),fe=e=>ve([100,e]),ve=e=>{const t=e.isNode?e:b(e);return R(t,"0"),R(t,["x","0"]),R(t,"1"),R(t,["y","1"]),t},ye={},me={fullSize:({rect:e,tree:t,node:n})=>{e.tran([t.children],()=>{const e=t.children.val.map(e=>{const t=e.elem.layout;return O(t.posAbs,t.sizAbs,()=>[y(t.posAbs.val,t.sizAbs.val),se(t.pos.val,t.siz.val)])});O(e,()=>{const t=ue(e.map(e=>e.val).reduce((e,t)=>{const[n,l]=e,[s,o]=t,[a,r]=n,[i,c]=l,[d,u]=s,[h,p]=o;return[[a>d?a:d,r>u?r:u],[a>d?i:h,r>u?c:p]]})[1]);n.val=t})})},fullSizeCor:({rect:e,node:t})=>{const n=b(),l=e.layout.sizAbs,s=e.layout.scale,o=e.inst.par.layout.sizAbs;e.tran([n,l,o,s],()=>{const[[e,a],[r,i]]=ce(n.val),[c,d]=l.val,[u,h]=o.val;t.val=[ee(e*c/u*s.val[0],r),ee(a*d/h*s.val[1],i)]})},scrollAbs:({elem:e,rect:t,node:n})=>{t.addEvent("scroll",()=>{n.val=[e.scrollLeft,e.scrollTop]}),t.tran([n],()=>{const[t,l]=n.val;e.scrollLeft=t,e.scrollTop=l})},id:({elem:e,rect:t,node:n})=>{t.unsafeTran(n,t=>{t&&e.setAttribute("id",t)})},scroll:({elem:e,rect:t,node:n})=>{const l=t.tran([t.layout.sizAbs],t=>{const n=e.scrollWidth,l=e.scrollHeight,s=Math.round(t[0]),o=Math.round(t[1]);return[n-s>=0?n-s:0,l-o>=0?l-o:0]});t.addEvent("scroll",()=>{const t=l.val;n.val=[0===t[0]?0:e.scrollLeft/t[0]*100,0===t[1]?0:e.scrollTop/t[1]*100]}),t.tran([n],()=>{const[t,s]=n.val,o=l.val,a=[Math.round(t/100*o[0]),Math.round(s/100*o[1])];e.scrollLeft!=a[0]&&(e.scrollLeft=a[0]),e.scrollTop!=a[1]&&(e.scrollTop=a[1])},ye)}};var be=e=>H(e,(e,t)=>(e.nodes&&r(e.nodes,([n,l])=>{const s="fullSize"==n?l:M(l),o=me[n];o&&o({node:s,elem:e.inst.dom,rect:e,tree:t})}),e));const ge=(e,t)=>ze({get:e,ports:new Set,isChan:!0,info:t}),ze=e=>new Proxy(e,{get:we,set:xe}),we=(e,t)=>"target"==t?e:e[t],xe=(e,t,n)=>"put"==t&&(e.get=n,e.ports.forEach(e=>{e.func()}),!0),Ee=(...t)=>{const n=t.length,l=t[n-1];let s,o,r;a(l)?(s=l,o=null,r=1):(s=t[n-2],o=l,r=2);const i=t.splice(0,n-r).map(t=>e(t)?t:[t]).reduce((e,t)=>e.concat(t));if(i.length>0){const e=s.length,t=[];for(let n=0;n<e;n++)t.push(i[n]);const n=ge(),l={chans:i,func:()=>{const e=s(...t.map(e=>e.get));e&&(n.put=e)},ref:o};return i.forEach(e=>{const t=e.target.ports;if(!t.has(l))if(o){const e=[...t].find(e=>e.ref==o);e?(Oe(e),t.add(l)):t.add(l)}else t.has(l)||t.add(l)}),{chan:n,listener:l}}return null},Ae=(...e)=>{const{chan:t}=Ee(...e);return t},Oe=e=>{e.chans.forEach(t=>{t.target.ports.delete(e)})},Se=(...e)=>{const t=e.length,n=e[t-1];let l,s,o;a(n)?(l=n,s=null,o=e.splice(0,t-1)):(l=e[t-2],s=n,o=e.splice(0,t-2));const r=Ee(...o,()=>{l(),Oe(r.listener)},s);return r},Te=(e={})=>{const t={pos:ve([0,0]),siz:ve([100,100]),posAbs:b(),sizAbs:b(),scale:ve([1,1]),disablePos:b(!1),disableSiz:b(!1),posChanged:ge(),sizChanged:ge(),posAbsChanged:ge(),sizAbsChanged:ge(),enablePosAbs:b(!1),enableSizAbs:b(!1)},n={tag:"div",isRect:!0,isSupp:!1,isCore:!0,oldVersions:[],init:ge(),stop:ge(),created:b(),removed:b(),inst:null,transitions:new Set,listeners:new Set,domEvents:[],data:new WeakMap([[Te,{}]]),layout:t,tran:Me,tranRef:Ce,listen:je,listenRef:Re,unsafeTran:ke,unsafeTranRef:Pe,addEvent:Le,withInst:He,withDOM:Ie,withPar:Be},l={};if(e.data)if((s=e.data).constructor&&"WeakMap"==s.constructor.name)l.data=e.data;else{const t=f(e.data);l.data=new WeakMap(t.map(({key:e,val:t})=>[e,[t]]))}var s;e.layout&&(l.layout=d(t,e.layout));const o=d(n,e,l);return o.layout&&(o.layout=c(e=>e.isChan?e:M(e),o.layout)),o},Ce=function(...e){const t=A(...e);return this.transitions.add(t.transition),t},Me=function(...e){const{transition:t,node:n}=A(...e);return this.transitions.add(t),n},Pe=function(...e){const t=S(...e);return this.transitions.add(t.transition),t},ke=function(...e){const{transition:t,node:n}=S(...e);return this.transitions.add(t),n},Re=function(...e){const t=Ee(...e);return this.listeners.add(t.listener),t},je=function(...e){const{listener:t,chan:n}=Ee(...e);return this.listeners.add(t),n},Ne=e=>{const t=Te(e);return t.isSupp=!0,t.isCore=!1,t},$e=(e,t)=>(r(t,([l,s])=>{if("data"==l){f(t.data).forEach(({key:t,val:n})=>{if(e.data.has(t)){const n=e.data.get(t);e.data.set(n.concat(t))}else e.data.set(t,[n])})}else"layout"==l?e.layout=d(e.layout,c(e=>e.isChan?e:M(e),s)):e[l]&&n(e[l])?e[l]=d(e[l],s):e[l]=s}),e),De=(e,t)=>({key:e,val:t}),We=e=>{const t=e.inst.dom;e.domEvents.forEach(({name:e})=>{t["on"+e]=null})},Le=function(e,t){this.inst.dom["on"+e]=t,this.domEvents.push({name:e,func:t})},He=function(e){const t=this;Se(t.init,()=>e(t.inst))},Ie=function(e){const t=this;Se(t.init,()=>e(t.inst.dom))},Be=function(e){const t=this;Se(t.init,()=>e(t.inst.par))},Ve=(e,t)=>W(Te(e),t),Fe=(e,t)=>W(Ne(e),t),Ye=e=>t=>H(n=>e(n)?t(n):n),qe=(e,t)=>(n,l)=>H(s=>e(s)?n(s):t(s)?l(s):s),Ge=Ye(e=>e.isCore),Je=Ye(e=>e.isSupp),Ke=Ye(e=>e.isTree),Qe=e=>t=>W(e(t.elem),t.children),Ue=(e,t)=>(e.elem=t(e.elem),e),Xe=(e,t)=>Ue(e,e=>$e(e,t)),Ze=(e,t,n,l)=>{const s=ve(l.scale),o=ve(e.pos),a=e.disablePos,r=e.posChanged,i=e.enablePosAbs;n.tran([o,s,a,i],()=>{if(!i.val)if(a.val){if("x"==a.val){const[e,n]=ce(o.val),l=s.val,a=e[1]*l[1];t.style.top=0==a?n[1]+"px":`calc(${a}% + ${n[1]}px)`,r.put=!0}else if("y"==a.val){const[e,n]=ce(o.val),l=s.val,a=e[0]*l[0];t.style.left=0==a?n[0]+"px":`calc(${a}% + ${n[0]}px)`,r.put=!0}}else{const[e,n]=ce(o.val),l=s.val,a=[e[0]*l[0],e[1]*l[1]];0==a[0]?t.style.left=n[0]+"px":t.style.left=`calc(${a[0]}% + ${n[0]}px)`,0==a[1]?t.style.top=n[1]+"px":t.style.top=`calc(${a[1]}% + ${n[1]}px)`,r.put=!0}});const c=ve(e.siz),d=e.disableSiz,u=e.sizChanged,h=e.enableSizAbs;n.tran([c,s,d,h],()=>{if(!h.val)if(d.val){if("x"==d.val){const[e,n]=ce(c.val),l=s.val,o=e[1]*l[1];t.style.height=0==o?n[1]+"px":`calc(${o}% + ${n[1]}px)`,u.put=!0}else if("y"==d.val){const[e,n]=ce(c.val),l=s.val,o=e[0]*l[0];t.style.width=0==o?n[0]+"px":`calc(${o}% + ${n[0]}px)`,u.put=!0}}else{const[e,n]=ce(c.val),l=s.val,o=[e[0]*l[0],e[1]*l[1]];0==o[0]?t.style.width=n[0]+"px":t.style.width=`calc(${o[0]}% + ${n[0]}px)`,0==o[1]?t.style.height=n[1]+"px":t.style.height=`calc(${o[1]}% + ${n[1]}px)`,u.put=!0}})},_e=(e,t,n,l,s,o,a,r,i,c,d,u)=>{e.tran([t,n,l,s,o,i,c].map(ve),(t,n,l,s,o)=>{const[h,p]=ce(t),[f,v]=ce(n);let m=[o[0]*l[0]/100,o[1]*l[1]/100],b=[f[0]*m[0],f[1]*m[1]],g=[h[0]*m[0]+s[0],h[1]*m[1]+s[1]];a.val=y(g,p),i.val&&("x"==d.val?e.inst.dom.style.top=a.val[1]-s[1]+"px":"y"==d.val?e.inst.dom.style.left=a.val[0]-s[0]+"px":0==d.val&&(e.inst.dom.style.left=a.val[0]-s[0]+"px",e.inst.dom.style.top=a.val[1]-s[1]+"px")),r.val=y(b,v),c.val&&("x"==u.val?e.inst.dom.style.height=r.val[1]+"px":"y"==u.val?e.inst.dom.style.width=r.val[0]+"px":0==u.val&&(e.inst.dom.style.width=r.val[0]+"px",e.inst.dom.style.height=r.val[1]+"px")),e.layout.posAbsChanged.put=!0,e.layout.sizAbsChanged.put=!0})},et=e=>lt(X(_(be(st(e))))),tt=(e,t)=>lt(X(_(be(ot(e,t))))),nt=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],lt=e=>H(e,e=>(e.css&&r(e.css,([t,n])=>{const l=M(n),s=e.inst.dom;e.tran(l,e=>{s.style[t]=e})}),e)),st=e=>{const t=b(nt()),n={layout:{posAbs:b([0,0]),sizAbs:t,scale:b([1,1])},flex:!1,inst:{dom:document.body}};if(window.onresize){const e=window.onresize;window.onresize=()=>{const n=e();return t.val=n,n}}else window.onresize=()=>{const e=nt();return t.val=e,e};return at(Q(e),n)},ot=(e,t)=>{const n=b([t.offsetWidth,t.offsetHeight]),l={layout:{posAbs:b([0,0]),sizAbs:n,scale:b([1,1])},flex:!1,inst:{dom:t}};return dt(t),new ResizeObserver(e=>{const t=e[0],{width:l,height:s}=t.contentRect;n.val=[l,s]}).observe(t),at(Q(e),l)},at=(e,t)=>{const n=e.elem;ct();const l=document.createElement(n.tag);dt(l),t.inst.dom.appendChild(l),n.inst={dom:l,par:t};const s=n.layout;return Ze(s,l,n,t.layout),_e(n,s.pos,s.siz,t.layout.scale,t.layout.posAbs,t.layout.sizAbs,s.posAbs,s.sizAbs,s.enablePosAbs,s.enableSizAbs,s.disablePos,s.disableSiz),n.oldVersions.forEach(e=>{e.inst=n.inst,e.init.put=!0,e.created.val=!0}),n.init.put=!0,n.created.val=!0,rt(e.children,n),e},rt=(e,t)=>{t.tran(e,()=>{let n=e.val,l=e.old;l||(l=[]),n||(n=[]);const s=l.filter(e=>!n.includes(e));n.filter(e=>!l.includes(e)).forEach(e=>at(e,t)),s.forEach(e=>it(e))})},it=e=>{const t=e.elem,n=t.inst.dom;return n.parentNode.removeChild(n),t.transitions.forEach(e=>{C(e)}),t.listeners.forEach(e=>{Oe(e)}),We(t),t.inst=null,t.stop.put=!0,t.removed.val=!0,t.created.val=!1,e.children.val=e.children.val.map(it),e},ct=()=>{if(!document.getElementById("dabr-style")){const e=".dabr::-webkit-scrollbar {width: 0 !important;height: 0 !important;}.dabr {overflow: -moz-scrollbars-none;scrollbar-width: none;-ms-overflow-style: none;}",t=document.createElement("style");t.setAttribute("id","dabr-style"),t.textContent=e,document.head.append(t)}},dt=e=>{e.className="dabr",e.style.position="absolute",e.style["overflow-y"]="scroll",e.style["overflow-x"]="scroll"},ut=(e,t)=>{const n=b(),l=b(),s=De(ut,{node:e,outter:!0,inner:!1}),o=t.elem,a=b(),r=Ne({layout:{pos:o.layout.pos,siz:o.layout.siz,sizAbs:a},data:s}),i=$e(o,{layout:{pos:n,siz:l}});return O([e,a],()=>{const[t,s]=pt(e.val,a.val);n.val=[te(t[0]),te(t[1])],l.val=[te(s[0]),te(s[1])]}),W(r,W(i,t.children))},ht=e=>t=>ut(e,t),pt=(e,t)=>{let n=t[0],l=t[1],s=[0,0],o=[0,0],a=e[0]/e[1];return e[0]>e[1]?(s[0]=n,s[1]=s[0]/a,s[1]>l?(s[1]=l,s[0]=s[1]*a,o[1]=0,o[0]=(n-s[0])/2):(o[0]=0,o[1]=(l-s[1])/2)):(n=t[0],l=t[1],s[1]=l,s[0]=s[1]*a,s[0]>n?(s[0]=n,s[1]=s[0]/a,o[0]=0,o[1]=(l-s[1])/2):(o[1]=0,o[0]=(n-s[0])/2)),[o,s]},ft=e=>{const t=Te(),n=t.layout.sizAbs,l=new Map,s=new Map,o=e=>{if(e.elem.inst){const t=e.elem.inst.dom,{top:n,left:s}=t.getBoundingClientRect();l.get(t).val=de([s,n])}};O(n,()=>{const t=[];[...l].entries(([,e])=>{t.push(e)}),N(t,()=>{e.forEach(o)})});const a=new ResizeObserver(e=>{const t=[];[...s].entries(([,e])=>{t.push(e)}),N(t,()=>{e.forEach(e=>{const{width:t,height:n}=e.contentRect;0!=t&&0!=n&&(s.get(e.target).val=de([t,n]))})})}),r=e.map(e=>{const t=e.elem,n=$e(t,{layout:{disablePos:!0,disableSiz:!0}});return n.withDOM(t=>{l.set(t,n.layout.pos),s.set(t,n.layout.siz),setTimeout(()=>o(e),0),a.observe(t)}),W(n,e.children)});return W(t,r)},vt=e=>{const t=Te(),n=new Map,l=new Map,s=new ResizeObserver(e=>{const t=[];[...l].entries(([,e])=>{t.push(e)}),N(t,()=>{e.forEach(e=>{const{width:t,height:n}=e.contentRect;0!=t&&0!=n&&(l.get(e.target).val=de([t,n]))})})}),o=e.map(e=>{const t=e.elem,o=$e(t,{layout:{disableSiz:!0}});return o.withDOM(e=>{n.set(e,o.layout.pos),l.set(e,o.layout.siz),s.observe(e)}),W(o,e.children)});return W(t,o)},yt=e=>{const t=Te(),n=t.layout.sizAbs,l=new Map,s=new Map,o=e=>{if(e.elem.inst){const t=e.elem.inst.dom;if(l.has(t)){const{top:e,left:n}=t.getBoundingClientRect();l.get(t).val=de([n,e])}}};O(n,()=>{const t=[];[...l].entries(([,e])=>{t.push(e)}),N(t,()=>{e.forEach(o)})});const a=e.map(e=>{const t=e.elem,n=$e(t,{layout:{disablePos:!0}});return n.withDOM(t=>{l.set(t,n.layout.pos),s.set(t,n.layout.siz),setTimeout(()=>o(e),0)}),W(n,e.children)});return W(t,a)},mt=(e,t)=>{const n=t.elem,l=b(),s=b(),o=O(e,({color:e})=>e),a=O(e,({width:e})=>e);O([a],()=>{const e=a.val;s.val=[ee(100,-2*e),ee(100,-2*e)],l.val=[te(e),te(e)]});const r=Ne({layout:{pos:n.layout.pos,siz:n.layout.siz},data:De(mt,{node:e,outter:!0,inner:!1}),style:{color:o}});return W(r,W($e(n,{layout:{pos:l,siz:s},data:De(mt,{node:e,inner:!0,outter:!1})}),t.children))},bt=e=>t=>mt(e,t),gt=(e,t)=>W(Ne({layout:{pos:t.elem.layout.pos,siz:t.elem.layout.siz},data:De(gt,e),style:{show:e}}),W($e(t.elem,{layout:{pos:[0,0],siz:[100,100]}}),t.children)),zt=e=>t=>gt(e,t),wt=(e,t)=>{const n=b(),l=i(t,e=>{const t=!!e.destroy&&e.destroy,n=b(!1);return{show:n,rectT:gt(n,e.content||e),destroy:t}}),s=b([100,100]);return O([e],()=>{const t=e.val;n.val=r(l,([e,n])=>{const{show:l,rectT:s,destroy:o}=n;return e==t?(l.val=!0,s):o?null:(l.val=!1,s)}).filter(o),s.val=[{rel:100,px:.01},100],s.val=[100,100]}),W(Ne({layout:{pos:[0,0],siz:s}}),n)},xt=(e,t)=>{const n=b([]),l=b([100,100]),s={};return O([e],e=>{const o=t[e];if(o)if(s[e])n.val.map(e=>{e.elem.style.show.val=!1}),s[e].elem.style.show.val=!0;else{n.val.map(e=>{e.elem.style.show.val=!1});const t=b(!0),l=gt(t,o());n.val=n.val.concat([l]),s[e]=l}l.val=[{rel:100,px:.01},100],l.val=[100,100]}),W(Ne({layout:{pos:[0,0],siz:l}}),n)},Et=e=>e,At=e=>e*e,Ot=e=>t=>Math.pow(t,e),St=e=>t=>1-e(t),Tt=(e,{finalVal:t,totalTime:n,timeFunction:l=Et,delta:s=10})=>{const o=e.val;if(o){const a=e.info.get(Tt);if(!p(o,t)&&!a){e.info.set(Tt,!0);let a=Mt(o,t);if(-1!=a){const[t,r]=a,i=kt(t),c=kt(r),d=v(c,i,(e,t)=>e-t);let u=s;const h=setInterval(()=>{u>=n&&(e.info.set(Tt,!1),clearInterval(h),u=n);let a=y((r=d,c=l(u/n),r.map(e=>e*c)),i);var r,c;let p=Pt(Rt(a,t),o);e.val=p,u+=s},s);return{handle:h,node:e}}}}return null},Ct=({handle:e,node:t})=>{t.info.set(Tt,!1),clearInterval(e)},Mt=(s,o)=>{if(p(s,o))return-1;if("boolean"==typeof s)return[s,o];if(e(s)&&!e(o)&&!l(o)||e(o)&&!e(s)&&!l(s)||t(s)&&!t(o)&&!l(o)||t(o)&&!t(s)&&!l(s))return-1;if(n(s)&&(n(o)||l(o))||n(o)&&(n(s)||l(s))){let e=s||{},t=o||{},n=h(e),l=h({...e,...t});return Object.entries(l).forEach(([s])=>{if(p(e[s],t[s]))delete l[s],delete n[s];else{let o=Mt(e[s],t[s]);if(o&&-1!=o){let[e,t]=o;n[s]=e,l[s]=t}}}),[n,l]}if(e(s)&&(e(o)||l(o))||e(o)&&(e(s)||l(s))){var a=s,r=o;if(null==s&&(a=o.map(()=>null)),null==o&&(r=s.map(()=>null)),a.length==r.length){let e=u(a),t=u(r);for(let n=0;n<e.length;n++)if(p(a[n],r[n]))delete t[n],delete e[n];else{let l=Mt(a[n],r[n]);if(l&&-1!=l){let[s,o]=l;e[n]=s,t[n]=o}}return[e,t]}return[s,o]}return[s,o]},Pt=(t,l)=>{if(n(t)){let e={};return Object.entries(l).forEach(([s])=>{o(t[s])?e[s]=Pt(t[s],l[s]):n(l[s])?e[s]=h(l[s]):e[s]=l[s]}),e}if(e(t)){let e=[];if(t.length==l.length){for(let s=0;s<l.length;s++)o(t[s])?e[s]=Pt(t[s],l[s]):n(l[s])?e[s]=h(l[s]):e[s]=l[s];return e}return null}return t},kt=e=>{if(s(e))return[e];if((e=>e&&"object"==typeof e)(e)){let t=[];return Object.values(e).forEach(e=>{let n=kt(e);n&&(t=t.concat(n))}),t}return null},Rt=(t,l)=>function t(l,a){if(s(a))return l.shift();if(n(a)){let e={};return Object.entries(a).forEach(([n,s])=>{e[n]=t(l,s)}),e}if(e(a)){let e=[];for(var r=0;r<a.length;r++)o(a[r])?e[r]=t(l,a[r]):delete e[r];return e}return null}(u(t),l),jt=e=>{const t=e.elem,n=b(),l=$e(t,{nodes:{scroll:n}}),s=b([50,0]);O([n],()=>{setTimeout(()=>{const e=95*n.val[1]/100;e>=0&&(s.val=[s.val[0],e])},0)});const o=b([0,0]),a=b([50,5]),r=ge();Ae([r],()=>{if(o.val){const e=r.get.offsetY;n.val=[0,e/o.val[1]*100]}}),Ae([over],()=>{s.val=[0,s.val[1]],a.val=[100,5]});const i=W(Te({layout:{pos:[ee(100,-10),0],siz:[ee(0,10),100],sizAbs:o},events:{click:r}}),Ve({layout:{pos:s,siz:a},style:{color:"orange"}}));return W(Ne(),[W(l,e.children),i])},Nt=()=>{const e=b(location.hash.slice(1));return window.addEventListener("hashchange",()=>{"#"+e.val!=location.hash&&(e.val=location.hash.slice(1))},!1),O([e],()=>{location.hash=e.val}),e},$t=e=>{const t=e.elem,n=(e=>(Se([e.init],()=>{const t=e.inst.par,n=t.layout.sizAbs,l=t.layout.scale,s=e.layout.sizAbs,o=e.layout.scale;O([n,l,s],()=>{o.val=[n.val[0]/s.val[0]*l.val[0],n.val[1]/s.val[1]*l.val[1]]})}),e))($e(t,{layout:{disableSiz:!0},css:{height:"max-content",width:"max-content","font-size":"0px",position:"relative"}})),l=new ResizeObserver(e=>{const t=e[0],{width:l,height:s}=t.contentRect;0!=l&&0!=s&&(n.layout.siz.val=de([l,s]))});n.withDOM(e=>{l.observe(e)});const s=O(e.children,e=>e.map(e=>Ue(e,e=>$e(e,{layout:{enablePosAbs:!0,enableSizAbs:!0}}))));return W(n,s)},Dt=e=>{const t=e.elem,n=(e=>(Se([e.init],()=>{const t=e.inst.par,n=t.layout.sizAbs,l=t.layout.scale,s=e.layout.sizAbs,o=e.layout.scale;O([n,l,s],()=>{o.val=[n.val[0]/s.val[0]*l.val[0],o.val[1]]})}),e))($e(t,{layout:{disableSiz:"x"},css:{width:"max-content","font-size":"0px",position:"relative"}})),l=new ResizeObserver(e=>{const t=e[0],{width:l,height:s}=t.contentRect;0!=l&&0!=s&&(n.layout.siz[0].val=te(l))});n.withDOM(e=>{l.observe(e)});const s=O(e.children,e=>e.map(e=>Ue(e,e=>$e(e,{layout:{enablePosAbs:!0,enableSizAbs:!0}}))));return W(n,s)},Wt=e=>{const t=e.elem,n=(e=>(Se([e.init],()=>{const t=e.inst.par,n=t.layout.sizAbs,l=t.layout.scale,s=e.layout.sizAbs,o=e.layout.scale;O([n,l,s],()=>{o.val=[o.val[0],n.val[1]/s.val[1]*l.val[1]]})}),e))($e(t,{layout:{disableSiz:"y"},css:{height:"max-content","font-size":"0px",position:"relative"}})),l=new ResizeObserver(e=>{const t=e[0],{width:l,height:s}=t.contentRect;0!=l&&0!=s&&(n.layout.siz[1].val=te(s))});n.withDOM(e=>{l.observe(e)});const s=O(e.children,e=>e.map(e=>Ue(e,e=>$e(e,{layout:{enablePosAbs:!0,enableSizAbs:!0}}))));return W(n,s)},Lt=(e,t)=>{let l,s;n(t)?(l=M(t.size),s=M(t.content)):(l=b("16px"),s=M(t));const o=Te({inline:!0,tag:e,layout:{disablePos:!0,disableSiz:!0},css:{position:"relative",display:"inline",width:"max-content",height:"max-content","font-size":l}});return o.withDOM(e=>{O(s,t=>{e.innerText=t})}),W(o)},Ht=e=>Xe(e,{inline:!0}),It=e=>{const t=e.map(e=>Xe(e,{css:{display:e.elem.inline?"inline":"inline-block",position:"relative","vertical-align":"middle"}}));return Wt(yt(t))},Bt=e=>{const t=e.map(e=>Xe(e,{css:{display:e.elem.isText?"inline":"inline-block",position:"relative","vertical-align":"middle"}}));return $t(yt(t))},Vt=e=>Ne({layout:{siz:e}}),Ft=e=>Vt(O([e],e=>[0,e])),Yt=e=>Vt(O([e],e=>[e,0])),qt=e=>{const t=e.map(e=>W($e(e.elem,{css:{display:"block",position:"relative"}}),e.children));return Wt(yt(t))},Gt=Bt,Jt=(e,t)=>{const n=t.elem.style?t.elem.style.css:null;return W($e(t.elem,{style:{css:n?O(n,e,(e,t)=>({...e,...t})):e}}),t.children)},Kt=e=>t=>Jt(e,t),Qt=e=>{const t=M(e),n=document.createElement("img"),l=ge(),s=Ne({layout:{pos:[0,0],siz:[100,100]},css:{overflow:"-moz-hidden-unscrollable"},data:De(Qt,{siz:l,dom:n})});return s.withDOM(e=>{O(t,t=>{n.setAttribute("src",t),n.style.width="auto",n.style.height="auto",n.addEventListener("load",()=>{const e=de([n.offsetWidth,n.offsetHeight]);l.put=e,n.style.width="100%",n.style.height="100%"}),e.appendChild(n)})}),W(s)},Ut=e=>{const t=Qt(e),[{siz:n}]=t.elem.data.get(Qt),l=b();return Ae(n,e=>{l.val=[e[0].px,e[1].px]}),ut(l,t)},Xt=e=>{let t,l,s,o,a;if(!e.isNode&&n(e)||e.isNode&&n(e.val)){const n=M(e);l=R(n,"content"),t=R(n,"fontSize"),s=R(n,"color"),o=R(n,"family"),a=R(n,"verticalAlign"),t.val||(t.val="16px"),s.val||(s.val="black"),o.val||(o.val="inherit"),a.val||(a.val="middle")}else l=M(e),t=b("16px"),s=b("black"),o=b("inherit"),a=b("middle");const r={content:l,size:t,color:s,family:o,verticalAlign:a};return Xe(Lt("div",{content:l,size:t}),{data:De(Xt,r),layout:{disablePos:!0,disableSiz:!0},css:{position:"relative",display:"inline",color:s,"font-family":o,"vertical-align":a}})},Zt=(e,t)=>{const n=Xt(e),l=Bt([n]),s=n.elem.data.get(Xt)[0],o=s.size,a=(e=>{const{family:t,content:n}=e;return O(t,n,(e,t)=>{const n=document.createElement("div");n.style.visibility="hidden",n.style.width="max-content",n.style["font-size"]="16px",e&&(n.style["font-family"]=e),n.innerText=t,document.body.appendChild(n);const l=n.offsetWidth,s=n.offsetHeight;return n.remove(),[l,s]})})(s),r=ut(a,W(t.elem,l));return O(t.elem.layout.sizAbs,a,([e],[t])=>{if(e>0){const l=(n=e/t*16,Math.round(1e3*(n+Number.EPSILON))/1e3);o.val=l+"px"}var n}),r},_t=()=>{const e=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],t=b(e());if(window.onresize){const e=window.onresize;window.onresize=()=>{const n=e();return t.val=n,n}}else window.onresize=()=>{const n=e();return t.val=n,n};return t};export{xt as Cond,Ot as EXPONENTIAL,B as Entry,ft as External,yt as ExternalPos,vt as ExternalSiz,St as FLIP,Qt as Img,Lt as Inline,Et as LINEAR,At as QUADRATIC,Te as Rect,Ve as RectT,Ne as Supp,Fe as SuppT,L as T,Xt as Text,W as Tree,bt as _border,zt as _container,I as _mapT,J as _pathT,ht as _proportional,Kt as _style,q as _walkT,_ as addChans,se as addCoord,Ze as addLayoutTriggers,ne as addLen,be as addNodes,X as addStyle,R as addSubNode,m as applyF,de as asPx,mt as border,ge as chan,Ye as cond,qe as condElse,gt as container,ve as coord,ue as copyCoord,he as copyLen,Ge as core,_e as defaultLayoutReactivity,D as endTransaction,Ut as fitImg,Zt as fitText,$t as flex,Dt as flexX,Wt as flexY,Q as fromStruc,ae as getPx,re as getRel,Nt as hashNode,Gt as horizontal,Yt as horizontalSpace,De as keyed,ee as len,Bt as line,Ae as listen,Se as listenOnce,Ee as listenRef,H as mapT,oe as mulCoord,le as mulLen,b as node,j as nodeObj,It as paragraph,G as pathT,$e as preserveR,Xe as preserveT,ut as proportional,te as px,We as removeEvents,Oe as removeListen,it as removeRect,C as removeTran,et as run,tt as runDOM,st as runRect,ot as runRectDOM,_t as screenSize,jt as scrollbar,Vt as space,ce as splitCoord,$ as startTransaction,Ct as stopTimed,Jt as style,k as subNode,P as subNode1,Je as supp,wt as switcher,Tt as timed,Ht as toInline,ie as toLen,M as toNode,K as toStruc,Qe as top,O as tran,A as tranRef,N as transaction,Ke as tree,T as unsafeTran,S as unsafeTranRef,qt as vertical,Ft as verticalSpace,Y as walkT,Ue as withTree,pe as x,fe as y};
