const t=t=>!!t&&t.constructor&&"Array"==t.constructor.name,e=e=>0==e&&!t(e)||!!e&&"object"!=typeof e&&e.constructor&&"Array"!=e.constructor.name,n=t=>!!t&&"object"==typeof t&&t.constructor&&"Array"!=t.constructor.name,o=t=>null==t||null==t,r=e=>0==e&&!t(e)||!!e&&"number"==typeof e,s=e=>0==e&&!t(e)||!!e,a=(t,e)=>Object.entries(t).map(e),i=(t,e)=>(t=>{let e={};return t.forEach(([t,n])=>{e[t]=n}),e})(Object.entries(t).map(([t,n])=>{let o=e(n,t);return o?[t,o]:null}).filter(s)),l=(...t)=>Object.assign({},...t),c=t=>t.slice(),u=t=>Object.assign({},t),d=(t,e)=>{let n=[],o=[];return function t(e,r){var s;if(null==e&&null==r)return!0;if(null==e&&null==r)return!0;if(isNaN(e)&&isNaN(r)&&"number"==typeof e&&"number"==typeof r)return!0;if(e===r)return!0;if("function"==typeof e&&"function"==typeof r||e instanceof Date&&r instanceof Date||e instanceof RegExp&&r instanceof RegExp||e instanceof String&&r instanceof String||e instanceof Number&&r instanceof Number)return e.toString()===r.toString();if(!(e instanceof Object&&r instanceof Object))return!1;if(e.isPrototypeOf(r)||r.isPrototypeOf(e))return!1;if(e.constructor!==r.constructor)return!1;if(e.prototype!==r.prototype)return!1;if(n.indexOf(e)>-1||o.indexOf(r)>-1)return!1;for(s in r){if(r.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;if(typeof r[s]!=typeof e[s])return!1}for(s in e){if(r.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;if(typeof r[s]!=typeof e[s])return!1;switch(typeof e[s]){case"object":case"function":if(n.push(e),o.push(r),!t(e[s],r[s]))return!1;n.pop(),o.pop();break;default:if(e[s]!==r[s])return!1}}return!0}(t,e)},h=e=>t(e)?e:[e],f=(t,e,n)=>t.map((t,o)=>n(t,e[o])),v=(t,e)=>f(t,e,(t,e)=>t+e),p=t=>e=>t.reduce((t,e)=>e(t),e),y=(t=null,e=new WeakMap)=>m({val:t,old:null,trans:new Set,changed:!1,isNode:!0,info:e}),m=t=>new Proxy(t,{set:g,get:b}),b=(t,e)=>"target"==e?t:t[e],g=(t,e,n,o)=>"val"==e&&(t.changed||d(t.val,n)||(t.old=t.val,t.val=n,t.changed=!0,t.trans.forEach(e=>{e.func()&&t.trans.delete(e)}),t.changed=!1),!0),_=t=>t.map(t=>s(t.val)).reduce((t,e)=>t&&e,!0),w=(t,e)=>{if(t.length>0){const n={nodes:t,func:e};return t.forEach(t=>{const e=t.target.trans;e.has(n)||e.add(n)}),_(t)&&e(),n}return null},E=(t,e,n)=>{if(e.length>0){const o={nodes:e,func:n,ref:t};return e.forEach(e=>{const n=e.target.trans;if(!n.has(o)){const e=[...n].find(e=>e.ref==t);e?(O(e),n.add(o)):n.add(o)}}),_(e)&&n(),o}return null},z=(t,e)=>w(t,()=>{_(t)&&e()}),O=t=>{t.nodes.forEach(e=>{e.target.trans.delete(t)})},A=t=>t.isNode?t:y(t),x=(t,e,n)=>{const o=y(null,n);return w(t,()=>{o.val=e()}),o},M=(t,e,n)=>{const o=y(null,n);return z(t,()=>{o.val=e()}),o},T=(t,e,n)=>x(t,()=>e(...t.map(t=>t.val)),n),k=(t,e,n)=>M(t,()=>e(...t.map(t=>t.val)),n),S=(t,e)=>T([t],t=>t[e]),L=(t,e)=>{const n=T([t],t=>t[e]);return w([n],()=>{const o=t.val;o[e]=n.val,t.val=o}),n},j=(e,n)=>{let o;return o=n?n.isNode?t(n.val)?n:T([n],h):n.isEntry?n:A(h(n)):y([]),{isTree:!0,val:e,children:o}},B=j,C=t=>(e,n=[])=>j(t(e.val,e,n),e.children.isEntry?e.children:T([e.children],e=>e.map((e,o)=>C(t)(e,n.concat(o))))),R=(t,e)=>{let n=null;return W((t,o)=>{d(o,e)&&(n=t)})(t),n},N=t=>R(t,[]),W=t=>(e,n=[])=>{t(e.val,n),e.children.isEntry||w([e.children],()=>{e.children.val.forEach((e,o)=>W(t)(e,n.concat(o)))})},D={isEntry:!0},P=(t,e)=>(t.children.isEntry?t.children=e:t.children=T([t.children],t=>t.map(t=>P(t,e))),t),H=t=>{const e=t.val;return e.isTree?H(P(e,t.children)):(t.children=T([t.children],t=>t.map(H)),t)},V={color:({elem:t,node:e})=>()=>{t.style["background-color"]=e.val},show:({elem:t,node:e})=>()=>{e.val?t.style.display="block":t.style.display="none"}};var $=C(t=>(t.style&&a(t.style,([e,n])=>{const o=A(n),r=V[e];if(r){const e=r({node:o,elem:t.inst.dom,rect:t}),n=w([o],e);t.renderTrans.add(n)}}),t));const I={click:({elem:t,channel:e})=>{t.addEventListener("click",t=>{e.put=t})},mouseOver:({elem:t,channel:e})=>{t.addEventListener("mouseover",t=>{e.put=t})},mouseEnter:({elem:t,channel:e})=>{t.addEventListener("mouseenter",t=>{e.put=t})},mouseMove:({elem:t,channel:e})=>{t.addEventListener("mousemove",t=>{e.put=t})},drag:({elem:t,channel:e})=>{let n=!1;t.addEventListener("mousedown",t=>{console.log("aAAAAAA"),n=!0,e.put=t}),t.addEventListener("mouseup",()=>{console.log("BBBBBBBBB"),n=!1,e.put=!1}),t.addEventListener("mousemove",t=>{n&&(e.put=t)})},mouseOut:({elem:t,channel:e})=>{t.addEventListener("mouseout",t=>{e.put=t})}};var q=C(t=>(t.events&&a(t.events,([e,n])=>{if(n.isChan){const o=I[e];o&&o({channel:n,elem:t.inst.dom,rect:t})}}),t));const F=(t,e)=>G({get:t,ports:new Set,isChan:!0,info:e}),G=t=>new Proxy(t,{get:J,set:K}),J=(t,e)=>"target"==e?t:t[e],K=(t,e,n)=>"put"==e&&(t.get=n,t.ports.forEach(t=>{t.func()}),!0),Q=(t,e)=>{const n={chans:t,func:e};return t.forEach(t=>{t.ports.add(n)}),n},U=(t,e,n)=>{const o={chans:e,func:n,ref:t};return e.forEach(e=>{const n=e.ports,r=[...n].find(e=>e.ref==t);r?(X(r),n.add(o)):n.add(o)}),o},X=t=>{t.chans.forEach(e=>{e.target.ports.delete(t)})},Y=(t,e)=>{const n=Q(t,()=>{e(),X(n)});return n},Z=(t,e)=>{const n=F();return Q(t,()=>{const t=e();s(t)&&(n.put=t)}),n},tt=(t,e)=>Z(t,()=>e(...t.map(t=>t.get))),et=(t,e)=>tt([t],t=>e(t)?t:null),nt=t=>{const e={pos:y(),siz:y(),posAbs:y(),sizAbs:y(),scale:y([1,1])},n={isRect:!0,isSupp:!1,isCore:!0,oldVersions:[],init:F(),stop:F(),created:y(),removed:y(),inst:null,renderTrans:new Set,domEvents:[],data:new WeakMap([[nt,{}]]),layout:e},o={};if(t.data)if((r=t.data).constructor&&"WeakMap"==r.constructor.name)o.data=t.data;else{const e=h(t.data);o.data=new WeakMap(e.map(({key:t,val:e})=>[t,[e]]))}var r;t.layout&&(o.layout=l(e,t.layout));const s=l(n,t,o);var a,c;return s.layout&&(s.layout=(a=A,c=s.layout,i(c,a))),s},ot=t=>{const e=nt(t);return e.isSupp=!0,e.isCore=!1,e},rt=(t,e)=>{const o={};if(a(e,([e,r])=>{t[e]&&n(t[e])?o[e]=l(t[e],r):o[e]=r}),e.data){const n=h(e.data);o.data=t.data,n.forEach(({key:t,val:e})=>{if(o.data.has(t)){const e=o.data.get(t);o.data.set(e.concat(t))}else o.data.set(t,[e])})}return o.inst=null,o.init=F(),o.created=y(),o.oldVersions=t.oldVersions.concat([t]),nt(l(t,o))},st=(t,e)=>({key:t,val:e}),at=t=>rt(ot({layout:{pos:[0,0],siz:[100,100]}}),t||{}),it=t=>{const e=t.inst.dom;t.domEvents.forEach(({name:t,func:n})=>{e["on"+t]=null})},lt=(t,e,n)=>{t.inst.dom["on"+e]=n,t.domEvents.push({name:e,func:n})},ct=(t,e)=>({rel:t,px:e}),ut=t=>ct(0,t),dt=(t,e)=>{const n=s(t.rel)?t:{px:0,rel:t},o=s(e.rel)?e:{px:0,rel:e};return ct(n.rel+o.rel,n.px+o.px)},ht=(t,e)=>{const n=e.rel?e:{px:0,rel:e};return ct(n.rel*t,n.px*t)},ft=(t,e)=>[dt(t[0],e[0]),dt(t[1],e[1])],vt=(t,e)=>[ht(t,e[0]),ht(t,e[1])],pt=t=>s(t.px)?t.px:0,yt=t=>s(t.rel)?t.rel:t,mt=([t,e])=>[[yt(t),yt(e)],[pt(t),pt(e)]],bt=([t,e])=>[ut(t),ut(e)],gt=([t,e])=>[_t(t),_t(e)],_t=t=>t.rel?u(t):t,wt={},Et={fullSize:({elem:t,rect:e,tree:n,node:o})=>{const r=w([n.children],()=>{const t=n.children.val.map(t=>{const e=t.val.layout,n=y();return w([e.posAbs,e.sizAbs],()=>{const t=v(e.posAbs.val,e.sizAbs.val),o=ft(e.pos.val,e.siz.val);n.val=[t,o]}),n});z(t,()=>{o.val=gt(t.map(t=>t.val).reduce((t,e)=>{const[n,o]=t,[r,s]=e,[a,i]=n,[l,c]=o,[u,d]=r,[h,f]=s;return[a>u?[a,l]:[u,h],i>d?[i,c]:[d,f]]})[1])})});e.renderTrans.add(r)},fullSizeCor:({elem:t,rect:e,tree:n,node:o})=>{const r=y(),s=(Et.fullSize({elem:t,rect:e,tree:n,node:r}),e.layout.sizAbs),a=e.layout.scale,i=e.inst.par.layout.sizAbs;w([r,s,i,a],()=>{const[[t,e],[n,l]]=mt(r.val),[c,u]=s.val,[d,h]=i.val;o.val=[ct(t*c/d*a.val[0],n),ct(e*u/h*a.val[1],l)]})},scrollAbs:({elem:t,rect:e,node:n})=>{lt(e,"scroll",()=>{n.val=[t.scrollLeft,t.scrollTop]});const o=w([n],()=>{const[e,o]=n.val;t.scrollLeft=e,t.scrollTop=o});e.renderTrans.add(o)},scroll:({elem:t,rect:e,node:n})=>{const o=T([e.layout.sizAbs],e=>{console.log("kakaka",e,t,t.scrollHeight);const n=t.scrollWidth,o=t.scrollHeight,r=Math.round(e[0]),s=Math.round(e[1]);return[n-r>=0?n-r:0,o-s>=0?o-s:0]});lt(e,"scroll",()=>{const e=o.val;n.val=[0===e[0]?0:t.scrollLeft/e[0]*100,0===e[1]?0:t.scrollTop/e[1]*100]});const r=E(wt,[n],()=>{const[e,r]=n.val,s=o.val,a=[Math.round(e/100*s[0]),Math.round(r/100*s[1])];t.scrollLeft!=a[0]&&(t.scrollLeft=a[0]),t.scrollTop!=a[1]&&(t.scrollTop=a[1])});e.renderTrans.add(r)}};var zt=C((t,e)=>(t.nodes&&a(t.nodes,([n,o])=>{const r="fullSize"==n?o:A(o),s=Et[n];s&&s({node:r,elem:t.inst.dom,rect:t,tree:e})}),t));const Ot=(t,e)=>j(nt(t),e),At=(t,e)=>j(ot(t),e),xt=t=>e=>C(n=>t(n)?e(n):n),Mt=(t,e)=>(n,o)=>C(r=>t(r)?n(r):e(r)?o(r):r),Tt=xt(t=>t.isCore),kt=xt(t=>t.isSupp),St=xt(t=>t.isTree),Lt=t=>e=>j(t(e.val),e.children),jt=(t,e,n,o)=>{const r=o.scale,s=t.pos,a=w([s,r],()=>{const[t,n]=mt(s.val),o=r.val;e.style.left=`calc(${t[0]*o[0]}% + ${n[0]}px)`,e.style.top=`calc(${t[1]*o[1]}% + ${n[1]}px)`});n.renderTrans.add(a);const i=t.siz,l=w([i,r],()=>{const[t,n]=mt(i.val),o=r.val;e.style.width=`calc(${t[0]*o[0]}% + ${n[0]}px)`,e.style.height=`calc(${t[1]*o[1]}% + ${n[1]}px)`});n.renderTrans.add(l)},Bt=(t,e,n,o,r,s,a)=>k([t,e,n,o,r],(t,e,n,o,r)=>{const[i,l]=mt(t),[c,u]=mt(e);let d=[r[0]*n[0]/100,r[1]*n[1]/100],h=[c[0]*d[0],c[1]*d[1]],f=[i[0]*d[0]+o[0],i[1]*d[1]+o[1]];s.val=v(f,l),a.val=v(h,u)});var Ct=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,o){return t[0]===e&&(n=o,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),o=this.__entries__[n];return o&&o[1]},e.prototype.set=function(e,n){var o=t(this.__entries__,e);~o?this.__entries__[o][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,o=t(n,e);~o&&n.splice(o,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,o=this.__entries__;n<o.length;n++){var r=o[n];t.call(e,r[1],r[0])}},e}()}(),Rt="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Nt="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Wt="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Nt):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var Dt=["top","right","bottom","left","width","height","size","weight"],Pt="undefined"!=typeof MutationObserver,Ht=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,o=!1,r=0;function s(){n&&(n=!1,t()),o&&i()}function a(){Wt(s)}function i(){var t=Date.now();if(n){if(t-r<2)return;o=!0}else n=!0,o=!1,setTimeout(a,e);r=t}return i}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){Rt&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Pt?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){Rt&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;Dt.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),Vt=function(t,e){for(var n=0,o=Object.keys(e);n<o.length;n++){var r=o[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},$t=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||Nt},It=Qt(0,0,0,0);function qt(t){return parseFloat(t)||0}function Ft(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+qt(t["border-"+n+"-width"])}),0)}function Gt(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return It;var o=$t(t).getComputedStyle(t),r=function(t){for(var e={},n=0,o=["top","right","bottom","left"];n<o.length;n++){var r=o[n],s=t["padding-"+r];e[r]=qt(s)}return e}(o),s=r.left+r.right,a=r.top+r.bottom,i=qt(o.width),l=qt(o.height);if("border-box"===o.boxSizing&&(Math.round(i+s)!==e&&(i-=Ft(o,"left","right")+s),Math.round(l+a)!==n&&(l-=Ft(o,"top","bottom")+a)),!function(t){return t===$t(t).document.documentElement}(t)){var c=Math.round(i+s)-e,u=Math.round(l+a)-n;1!==Math.abs(c)&&(i-=c),1!==Math.abs(u)&&(l-=u)}return Qt(r.left,r.top,i,l)}var Jt="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof $t(t).SVGGraphicsElement}:function(t){return t instanceof $t(t).SVGElement&&"function"==typeof t.getBBox};function Kt(t){return Rt?Jt(t)?function(t){var e=t.getBBox();return Qt(0,0,e.width,e.height)}(t):Gt(t):It}function Qt(t,e,n,o){return{x:t,y:e,width:n,height:o}}var Ut=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Qt(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=Kt(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),Xt=function(t,e){var n,o,r,s,a,i,l,c=(o=(n=e).x,r=n.y,s=n.width,a=n.height,i="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(i.prototype),Vt(l,{x:o,y:r,width:s,height:a,top:r,right:o+s,bottom:a+r,left:o}),l);Vt(this,{target:t,contentRect:c})},Yt=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new Ct,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof $t(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new Ut(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof $t(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new Xt(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),Zt="undefined"!=typeof WeakMap?new WeakMap:new Ct,te=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Ht.getInstance(),o=new Yt(e,n,this);Zt.set(this,o)};["observe","unobserve","disconnect"].forEach((function(t){te.prototype[t]=function(){var e;return(e=Zt.get(this))[t].apply(e,arguments)}}));var ee=void 0!==Nt.ResizeObserver?Nt.ResizeObserver:te;const ne=t=>$(q(zt(se(t)))),oe=(t,e)=>$(q(zt(ae(t,e)))),re=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],se=t=>{const e=y(re()),n={layout:{posAbs:y([0,0]),sizAbs:e,scale:y([1,1])},flex:!1,inst:{dom:document.body}};return window.onresize=()=>{e.val=re()},ie(H(t),n)},ae=(t,e)=>{const n=y([e.offsetWidth,e.offsetHeight]),o={layout:{posAbs:y([0,0]),sizAbs:n,scale:y([1,1])},flex:!1,inst:{dom:e}};return de(e),new ee(t=>{const e=t[0],{width:o,height:r}=e.contentRect;n.val=[o,r]}).observe(e),ie(H(t),o)},ie=(t,e)=>{const n=t.val;ue();const o=document.createElement("div");de(o),e.inst.dom.appendChild(o),n.inst={dom:o,par:e};const r=n.layout;return jt(r,o,n,e.layout),Bt(r.pos,r.siz,e.layout.scale,e.layout.posAbs,e.layout.sizAbs,r.posAbs,r.sizAbs),n.oldVersions.forEach(t=>{t.inst=n.inst,t.init.put=!0,t.created.val=!0}),n.init.put=!0,n.created.val=!0,le(t.children,n),t},le=(t,e)=>{const n=w([t],()=>{let n=t.val,o=t.old;o||(o=[]),n||(n=[]);const r=o.filter(t=>!n.includes(t));n.filter(t=>!o.includes(t)).forEach(t=>ie(t,e)),r.forEach(t=>ce(t))});e.renderTrans.add(n)},ce=t=>{const e=t.val,n=e.inst.dom;return n.parentNode.removeChild(n),e.renderTrans.forEach(t=>{O(t)}),it(e),e.inst=null,e.stop.put=!0,e.removed.val=!0,e.created.val=!1,t.children.val=t.children.val.map(ce),t},ue=()=>{if(!document.getElementById("dabr-style")){const t=".dabr::-webkit-scrollbar {width: 0 !important;height: 0 !important;}.dabr {overflow: -moz-scrollbars-none;scrollbar-width: none;-ms-overflow-style: none;}",e=document.createElement("style");e.setAttribute("id","dabr-style"),e.textContent=t,document.head.append(e)}},de=t=>{t.className="dabr",t.style.position="absolute",t.style["overflow-y"]="scroll",t.style["overflow-x"]="scroll"},he=t=>e=>{const n=y(),o=y(),r=T([t],({color:t})=>t),s=T([t],({width:t})=>t);return w([s],()=>{const t=s.val;n.val=[ut(t),ut(t)],o.val=[ct(100,-2*t),ct(100,-2*t)]}),j(ot({layout:{pos:e.layout.pos,siz:e.layout.siz},data:st(he,{node:t,outter:!0,inner:!1}),style:{color:r}}),[j(rt(e,{layout:{pos:n,siz:o},data:st(he,{node:t,inner:!0,outter:!1})}),D)])},fe=t=>e=>j(at({data:st(fe,t),style:{show:t}}),[j(e,D)]),ve=t=>e=>{const n=y(),o=y(),r=st(ve,{node:t,outter:!0,inner:!1}),s=rt(e,{layout:{pos:n,siz:o},data:r});return Y([s.init],()=>{const e=s.inst.par.layout.sizAbs;w([t,e],()=>{const[r,s]=pe(t.val,e.val);n.val=[ut(r[0]),ut(r[1])],o.val=[ut(s[0]),ut(s[1])]})}),At({layout:{pos:e.layout.pos,siz:e.layout.siz},data:r},j(s,D))},pe=(t,e)=>{let n=e[0],o=e[1],r=[0,0],s=[0,0],a=t[0]/t[1];return t[0]>t[1]?(r[0]=n,r[1]=r[0]/a,r[1]>o?(r[1]=o,r[0]=r[1]*a,s[1]=0,s[0]=(n-r[0])/2):(s[0]=0,s[1]=(o-r[1])/2)):(n=e[0],o=e[1],r[1]=o,r[0]=r[1]*a,r[0]>n?(r[0]=n,r[1]=r[0]/a,s[0]=0,s[1]=(o-r[1])/2):(s[1]=0,s[0]=(n-r[0])/2)),[s,r]},ye=(t,e)=>{const n=y(),o=i(e,t=>{const e=!!t.destroy&&t.destroy,n=y(!1);return{show:n,rectT:Lt(fe(n))(t.content||t),destroy:e}}),r=y([100,100]);return w([t],()=>{const e=t.val;n.val=a(o,([t,n])=>{const{show:o,rectT:r,destroy:s}=n;return t==e?(o.val=!0,r):s?null:(o.val=!1,r)}).filter(s),r.val=[{rel:100,px:.01},{rel:100,px:0}],r.val=[100,100],console.log("aaaaaaaaaa",r.val)}),j(nt({layout:{pos:[0,0],siz:r}}),n)},me=t=>t,be=t=>t*t,ge=t=>e=>Math.pow(e,t),_e=t=>e=>1-t(e),we=(t,{finalVal:e,totalTime:n,timeFunction:o=me,delta:r=10})=>{const s=t.val;if(s){const a=t.info.get(we);if(!d(s,e)&&!a){t.info.set(we,!0);let a=ze(s,e);if(-1!=a){const[e,i]=a,l=Ae(e),c=Ae(i),u=f(c,l,(t,e)=>t-e);let d=r;const h=setInterval(()=>{d>=n&&(t.info.set(we,!1),clearInterval(h),d=n);let a=v((i=u,c=o(d/n),i.map(t=>t*c)),l);var i,c;let f=Oe(xe(a,e),s);t.val=f,d+=r},r);return{handle:h,node:t}}}}return null},Ee=({handle:t,node:e})=>{e.info.set(we,!1),clearInterval(t)},ze=(r,s)=>{if(d(r,s))return-1;if("boolean"==typeof r)return[r,s];if(t(r)&&!t(s)&&!o(s)||t(s)&&!t(r)&&!o(r)||e(r)&&!e(s)&&!o(s)||e(s)&&!e(r)&&!o(r))return-1;if(n(r)&&(n(s)||o(s))||n(s)&&(n(r)||o(r))){let t=r||{},e=s||{},n=u(t),o=u({...t,...e});return Object.entries(o).forEach(([r])=>{if(d(t[r],e[r]))delete o[r],delete n[r];else{let s=ze(t[r],e[r]);if(s&&-1!=s){let[t,e]=s;n[r]=t,o[r]=e}}}),[n,o]}if(t(r)&&(t(s)||o(s))||t(s)&&(t(r)||o(r))){var a=r,i=s;if(null==r&&(a=s.map(()=>null)),null==s&&(i=r.map(()=>null)),a.length==i.length){let t=c(a),e=c(i);for(let n=0;n<t.length;n++)if(d(a[n],i[n]))delete e[n],delete t[n];else{let o=ze(a[n],i[n]);if(o&&-1!=o){let[r,s]=o;t[n]=r,e[n]=s}}return[t,e]}return[r,s]}return[r,s]},Oe=(e,o)=>{if(n(e)){let t={};return Object.entries(o).forEach(([r])=>{s(e[r])?t[r]=Oe(e[r],o[r]):n(o[r])?t[r]=u(o[r]):t[r]=o[r]}),t}if(t(e)){let t=[];if(e.length==o.length){for(let r=0;r<o.length;r++)s(e[r])?t[r]=Oe(e[r],o[r]):n(o[r])?t[r]=u(o[r]):t[r]=o[r];return t}return null}return e},Ae=t=>{if(r(t))return[t];if((e=t)&&"object"==typeof e){let e=[];return Object.values(t).forEach(t=>{let n=Ae(t);n&&(e=e.concat(n))}),e}return null;var e},xe=(e,o)=>function e(o,a){if(r(a))return o.shift();if(n(a)){let t={};return Object.entries(a).forEach(([n,r])=>{t[n]=e(o,r)}),t}if(t(a)){let t=[];for(var i=0;i<a.length;i++)s(a[i])?t[i]=e(o,a[i]):delete t[i];return t}return null}(c(e),o),Me=t=>{const e=t.val,n=y(),o=rt(e,{nodes:{scroll:n}}),r=y([50,0]);w([n],()=>{const t=n.val[1],e=95*t/100;console.log(";))))))))))",t,e),e>=0&&(r.val=[r.val[0],e])});y([0,0]);const s=y([0,0]),a=(F(),F(),F(),y([50,5])),i=(F(),j(nt({layout:{pos:[ct(100,-10),0],siz:[ct(0,10),100],sizAbs:s}}),Ot({layout:{pos:r,siz:a},style:{color:"orange"}})));return j(at(),[j(o,t.children),i])},Te=()=>{const t=y(location.hash.slice(1));return window.addEventListener("hashchange",()=>{"#"+t.val!=location.hash&&(t.val=location.hash.slice(1))},!1),w([t],()=>{location.hash=t.val}),t};window.c=Te();const ke=t=>e=>{const n=y(),o=y();return e.data.set(ke,{size:n,dom:o}),Y([e.init],()=>{T([t],({color:t,size:n,family:r,align:s,content:a,wordBreak:i,whiteSpace:l})=>{const c=e.inst.dom,u=c.getElementsByClassName("dabr-text");let d;1==u.length?d=u[0]:(d=document.createElement("div"),c.appendChild(d)),c.style.overflow="hidden",d.style.color=t||"black",d.style["font-size"]=n||"16px",s&&(d.style["text-align"]=s),r&&(d.style["font-family"]=r),d.style["word-break"]=i||"break-all",l&&(d.style["white-space"]=l),d.classList.add("dabr-text"),d.innerText=a,o.val=d}),w([e.layout.sizAbs,t],()=>{const t=o.val,e=[t.offsetWidth,t.offsetHeight];0!=e[0]&&0!=e[1]&&(n.val=e)})}),e},Se=(t,e)=>{const n=ke(t)(e),{size:o}=n.data.get(ke);return z([o],()=>{const[,t]=bt(o.val),[e]=n.layout.siz.val;n.layout.siz.val=[e,t]}),n},Le=t=>e=>n=>{const o=y(),r=[];e.forEach((t,e)=>{r[e]=y()}),w(e,()=>{const t=e.map(t=>(({color:t="black",family:e,align:n,content:o})=>{const r=document.createElement("div");r.style.visibility="hidden",r.style.width="max-content",r.style["font-size"]="16px",e&&(r.style["font-family"]=e),r.innerText=o,document.body.appendChild(r);const s=r.offsetWidth,a=r.offsetHeight;return r.remove(),[s,a]})(t.val));t.forEach((t,e)=>{r[e].val=t});const n=t.map(([t])=>t),s=t.map(([,t])=>t),a=n.reduce((t,e)=>Math.max(t,e)),i=s.reduce((t,e)=>t+e);o.val=[a,i]});const s=y(),a=e.length,i=e.map((e,n)=>{const i=x([e,s],()=>({...e.val,size:s.val,whiteSpace:"nowrap"})),l=n/a*100,c=T([r[n],o],([t,e],[n,o])=>[t/n*100,1/a*100]),u=t(c,l),d=ot({layout:{pos:u,siz:c}});return j(ke(i)(d))}),l=i.map(t=>t.val.layout.sizAbs);return z(l.concat([o]),()=>{const t=l.map(t=>t.val[0]).reduce((t,e)=>Math.max(t,e)),e=o.val[0],n=(r=t/e*16,Math.round(1e3*(r+Number.EPSILON))/1e3);var r;s.val=n+"px"}),j(ve(o)(n),i)},je=Le((t,e)=>y([0,e])),Be=Le((t,e)=>T([t],([t,n])=>[100-t,e])),Ce=Le((t,e)=>T([t],([t,n])=>[(100-t)/2,e])),Re=t=>je([t]),Ne=t=>(t.reduce((t,e)=>(w([t.val.layout.pos,t.val.layout.siz],()=>{const n=t.val.layout.pos.val,o=t.val.layout.siz.val,r=ft(n,o);e.val.layout.pos.val=[e.val.layout.pos.val[0],r[1]]}),e),Ot({layout:{pos:[0,0],siz:[0,0]}})),t),We=t=>(t.reduce((t,e)=>(z([t.val.layout.pos,t.val.layout.siz],()=>{const n=t.val.layout.pos.val,o=t.val.layout.siz.val,r=ft(n,o);e.val.layout.pos.val=[r[0],0]}),e),Ot({layout:{pos:[0,0],siz:[0,0]}})),t),De=t=>at({layout:{pos:[0,0],siz:t}}),Pe=t=>De(T([t],t=>[0,t])),He=t=>De(T([t],t=>[t,0])),Ve=t=>{const e=y([100,100]);return Y([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(Y([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;w([n,o,r],()=>{s.val=[n.val[0]/r.val[0]*o.val[0],n.val[1]/r.val[1]*o.val[1]]})}),t))(rt(t,{layout:{siz:e},nodes:{fullSize:e}}))},$e=t=>{const e=y([100,100]),n=T([e,t.layout.siz],([t],[,e])=>[t,e]);return Y([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(Y([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;w([n,o,r],()=>{s.val=[n.val[0]/r.val[0]*o.val[0],s.val[1]]})}),t))(rt(t,{layout:{siz:n},nodes:{fullSize:e}}))},Ie=t=>{const e=y([100,100]),n=T([e,t.layout.siz],([,t],[e])=>[e,t]);return Y([t.init],()=>{t.inst.dom.style.overflow="hidden"}),(t=>(Y([t.init],()=>{const e=t.inst.par,n=e.layout.sizAbs,o=e.layout.scale,r=t.layout.sizAbs,s=t.layout.scale;w([n,o,r],()=>{s.val=[s.val[0],n.val[1]/r.val[1]*o.val[1]]})}),t))(rt(t,{layout:{siz:n},nodes:{fullSize:e}}))};export{at as Dummy,ge as EXPONENTIAL,D as Entry,_e as FLIP,me as LINEAR,be as QUADRATIC,nt as Rect,Ot as RectT,ot as Supp,At as SuppT,B as T,j as Tree,q as addChans,ft as addCoord,lt as addEvent,jt as addLayoutTriggers,dt as addLen,zt as addNodes,$ as addStyle,p as applyF,bt as asPx,he as border,F as chan,Z as chanL,xt as cond,Mt as condElse,fe as container,gt as copyCoord,_t as copyLen,Tt as core,Bt as defaultLayoutReactivity,et as filterC,H as flatten,Ve as flex,$e as flexX,Ie as flexY,N as getFirst,pt as getPx,yt as getRel,Te as hashNode,We as horizontal,He as horizontalSpace,st as keyed,ct as len,Re as line,Ce as linesC,je as linesL,Be as linesR,Le as linesTemplate,Q as listen,Y as listenOnce,U as listenRef,tt as mapC,T as mapN,C as mapT,vt as mulCoord,ht as mulLen,y as node,x as nodeT,Se as paragraph,rt as preserveR,ve as proportional,ut as px,it as removeEvents,X as removeListen,ce as removeRect,O as removeTran,ne as run,oe as runDOM,se as runRect,ae as runRectDOM,k as safeMapN,M as safeNodeT,z as safeTran,Me as scrollbar,De as space,mt as splitCoord,Ee as stopTimed,S as subNode,L as subNode2,kt as supp,ye as switcher,ke as text,we as timed,A as toNode,Lt as top,w as tran,E as tranRef,St as tree,R as treePath,Ne as vertical,Pe as verticalSpace,W as walkT};
